# 12. add-features ëª…ë ¹ì–´

ê¸°ì¡´ Feature Groupì— ìƒˆë¡œìš´ featureë“¤ì„ ì¶”ê°€í•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

## ê¸°ë³¸ ì‚¬ìš©ë²•

```bash
# ìƒˆë¡œìš´ feature ì¶”ê°€
fs add-features my-feature-group features.json

# ì‹¤ì œ ì¶”ê°€ ì „ ë¯¸ë¦¬ë³´ê¸°
fs add-features my-feature-group features.json --dry-run

# ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰ (ì™„ë£Œ ëŒ€ê¸° ì•ˆí•¨)
fs add-features my-feature-group features.json --no-wait
```

## ëª…ë ¹ì–´ ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `FEATURE_GROUP_NAME` | ëŒ€ìƒ Feature Group ì´ë¦„ (í•„ìˆ˜) | - |
| `FEATURES_FILE` | ìƒˆë¡œìš´ feature definition JSON íŒŒì¼ (í•„ìˆ˜) | - |
| `--dry-run` | ì‹¤ì œ ì¶”ê°€ ì—†ì´ ë¯¸ë¦¬ë³´ê¸°ë§Œ ì‹¤í–‰ | False |
| `--wait/--no-wait` | ì—…ë°ì´íŠ¸ ì™„ë£Œê¹Œì§€ ëŒ€ê¸° ì—¬ë¶€ | True |

## Feature Definition íŒŒì¼ í˜•ì‹

ìƒˆë¡œìš´ featureë“¤ì€ JSON ë°°ì—´ í˜•íƒœë¡œ ì •ì˜í•©ë‹ˆë‹¤:

```json
[
  {
    "FeatureName": "user_age_category",
    "FeatureType": "String",
    "Description": "ì‚¬ìš©ì ì—°ë ¹ëŒ€ ì¹´í…Œê³ ë¦¬"
  },
  {
    "FeatureName": "purchase_amount",
    "FeatureType": "Fractional",
    "Description": "êµ¬ë§¤ ê¸ˆì•¡"
  },
  {
    "FeatureName": "product_embeddings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 256
      }
    },
    "Description": "ìƒí’ˆ ì„ë² ë”© ë²¡í„°"
  }
]
```

### ì§€ì›í•˜ëŠ” Feature Type

| Type | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| `String` | ë¬¸ìì—´ ë°ì´í„° | "premium", "active" |
| `Integral` | ì •ìˆ˜í˜• ë°ì´í„° | 25, 100, -5 |
| `Fractional` | ì‹¤ìˆ˜í˜• ë°ì´í„° | 3.14, 99.99 |

### ì§€ì›í•˜ëŠ” Collection Type

| Type | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| `List` | ë²¡í„°/ë°°ì—´ í˜•íƒœ | [0.1, 0.2, 0.3] |
| `Set` | ì§‘í•© í˜•íƒœ | {"red", "blue"} |

## ìƒì„¸ ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ Feature ì¶”ê°€

```bash
# 1. Feature definition íŒŒì¼ ìƒì„±
cat > new_features.json << EOF
[
  {
    "FeatureName": "customer_segment",
    "FeatureType": "String",
    "Description": "ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ ë¶„ë¥˜"
  },
  {
    "FeatureName": "lifetime_value",
    "FeatureType": "Fractional", 
    "Description": "ê³ ê° ìƒì•  ê°€ì¹˜"
  },
  {
    "FeatureName": "interaction_count",
    "FeatureType": "Integral",
    "Description": "ì´ ìƒí˜¸ì‘ìš© íšŸìˆ˜"
  }
]
EOF

# 2. ë¯¸ë¦¬ë³´ê¸°ë¡œ í™•ì¸
fs add-features customer-profiles new_features.json --dry-run

# ì¶œë ¥ ì˜ˆì‹œ:
# ğŸš€ Feature ì¶”ê°€ í”„ë¡œì„¸ìŠ¤ ì‹œì‘...
# âœ“ í˜„ì¬ Feature Group: customer-profiles
# âœ“ ê¸°ì¡´ feature ìˆ˜: 8
# âœ“ ì¶”ê°€í•  feature ìˆ˜: 3
#   + customer_segment (String)
#   + lifetime_value (Fractional)
#   + interaction_count (Integral)
# ğŸ” [DRY RUN] ì‹¤ì œ ì¶”ê°€í•˜ì§€ ì•Šê³  ë¯¸ë¦¬ë³´ê¸°ë§Œ ì‹¤í–‰í•©ë‹ˆë‹¤.

# 3. ì‹¤ì œ ì¶”ê°€
fs add-features customer-profiles new_features.json

# ì¶œë ¥ ì˜ˆì‹œ:
# ğŸ“ Feature ì¶”ê°€ ì¤‘...
# âœ“ Feature ì¶”ê°€ ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!
# â³ Feature ì¶”ê°€ ì™„ë£Œê¹Œì§€ ëŒ€ê¸° ì¤‘...
# âœ… Feature ì¶”ê°€ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!
```

### ë²¡í„°/ì„ë² ë”© Feature ì¶”ê°€

```bash
# ê³ ì°¨ì› ë²¡í„° feature ì •ì˜
cat > embedding_features.json << EOF
[
  {
    "FeatureName": "text_embeddings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 768
      }
    },
    "Description": "í…ìŠ¤íŠ¸ ì„ë² ë”© ë²¡í„° (BERT ê¸°ë°˜)"
  },
  {
    "FeatureName": "image_features",
    "FeatureType": "String", 
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 2048
      }
    },
    "Description": "ì´ë¯¸ì§€ íŠ¹ì„± ë²¡í„° (ResNet ê¸°ë°˜)"
  },
  {
    "FeatureName": "user_tags",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ì‚¬ìš©ì íƒœê·¸ ì§‘í•©"
  }
]
EOF

fs add-features ml-features embedding_features.json
```

### ë³µí•© ë°ì´í„° íƒ€ì… Feature ì¶”ê°€

```bash
# ë‹¤ì–‘í•œ íƒ€ì…ì˜ featureë“¤ì„ í•œ ë²ˆì— ì¶”ê°€
cat > complex_features.json << EOF
[
  {
    "FeatureName": "purchase_history_summary",
    "FeatureType": "String",
    "Description": "êµ¬ë§¤ ì´ë ¥ ìš”ì•½ (JSON ë¬¸ìì—´)"
  },
  {
    "FeatureName": "product_ratings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 100
      }
    },
    "Description": "ìƒí’ˆë³„ í‰ì  ë°°ì—´"
  },
  {
    "FeatureName": "preferred_categories",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ì„ í˜¸ ì¹´í…Œê³ ë¦¬ ì§‘í•©"
  },
  {
    "FeatureName": "recommendation_score",
    "FeatureType": "Fractional",
    "Description": "ì¶”ì²œ ì ìˆ˜"
  },
  {
    "FeatureName": "visit_frequency",
    "FeatureType": "Integral", 
    "Description": "ì›”ê°„ ë°©ë¬¸ íšŸìˆ˜"
  }
]
EOF

fs add-features ecommerce-features complex_features.json
```

## ê³ ê¸‰ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### 1. ë°°ì¹˜ Feature ì¶”ê°€ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# batch_feature_addition.sh - ì—¬ëŸ¬ Feature Groupì— ì¼ê´€ëœ feature ì¶”ê°€

FEATURE_GROUPS=("user_profiles" "product_catalog" "transaction_history")
FEATURE_FILE="common_analytics_features.json"

# ê³µí†µìœ¼ë¡œ ì¶”ê°€í•  analytics featureë“¤
cat > "$FEATURE_FILE" << EOF
[
  {
    "FeatureName": "created_timestamp",
    "FeatureType": "Fractional",
    "Description": "ë ˆì½”ë“œ ìƒì„± íƒ€ì„ìŠ¤íƒ¬í”„ (Unix epoch)"
  },
  {
    "FeatureName": "last_updated",
    "FeatureType": "String", 
    "Description": "ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ (ISO 8601)"
  },
  {
    "FeatureName": "data_version",
    "FeatureType": "String",
    "Description": "ë°ì´í„° ë²„ì „ ì •ë³´"
  },
  {
    "FeatureName": "quality_score",
    "FeatureType": "Fractional",
    "Description": "ë°ì´í„° í’ˆì§ˆ ì ìˆ˜ (0.0-1.0)"
  }
]
EOF

echo "ğŸš€ ë°°ì¹˜ Feature ì¶”ê°€ í”„ë¡œì„¸ìŠ¤ ì‹œì‘"
echo "ëŒ€ìƒ Feature Groups: ${FEATURE_GROUPS[*]}"
echo "ì¶”ê°€í•  Feature íŒŒì¼: $FEATURE_FILE"
echo ""

successful_updates=0
failed_updates=0
update_log="batch_update_$(date +%Y%m%d_%H%M%S).log"

for fg in "${FEATURE_GROUPS[@]}"; do
    echo "ğŸ“Š Processing: $fg"
    
    # ë¯¸ë¦¬ë³´ê¸° ì‹¤í–‰
    echo "  ğŸ” ë¯¸ë¦¬ë³´ê¸° ì‹¤í–‰ ì¤‘..." | tee -a "$update_log"
    if fs add-features "$fg" "$FEATURE_FILE" --dry-run >> "$update_log" 2>&1; then
        echo "  âœ… ë¯¸ë¦¬ë³´ê¸° ì„±ê³µ"
        
        # ì‹¤ì œ ì—…ë°ì´íŠ¸ ì‹¤í–‰
        echo "  ğŸ“ Feature ì¶”ê°€ ì¤‘..." | tee -a "$update_log"
        if fs add-features "$fg" "$FEATURE_FILE" >> "$update_log" 2>&1; then
            echo "  âœ… $fg ì—…ë°ì´íŠ¸ ì„±ê³µ"
            successful_updates=$((successful_updates + 1))
        else
            echo "  âŒ $fg ì—…ë°ì´íŠ¸ ì‹¤íŒ¨"
            failed_updates=$((failed_updates + 1))
        fi
    else
        echo "  âŒ $fg ë¯¸ë¦¬ë³´ê¸° ì‹¤íŒ¨ (ìŠ¤í‚µë¨)"
        failed_updates=$((failed_updates + 1))
    fi
    
    echo ""
    
    # API ì œí•œ ê³ ë ¤í•œ ë”œë ˆì´
    sleep 2
done

# ê²°ê³¼ ìš”ì•½
echo "ğŸ“‹ ë°°ì¹˜ ì—…ë°ì´íŠ¸ ì™„ë£Œ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ì´ ëŒ€ìƒ: ${#FEATURE_GROUPS[@]}ê°œ"
echo "ì„±ê³µ: $successful_updatesê°œ"
echo "ì‹¤íŒ¨: $failed_updatesê°œ"
echo "ë¡œê·¸ íŒŒì¼: $update_log"

# ì‹¤íŒ¨í•œ ê²½ìš° ë¡œê·¸ í‘œì‹œ
if [ $failed_updates -gt 0 ]; then
    echo ""
    echo "âŒ ì‹¤íŒ¨ ìƒì„¸ ì •ë³´:"
    grep -A 5 -B 2 "ì‹¤íŒ¨\|error\|Error" "$update_log" || true
fi

echo ""
echo "ğŸ” ëª¨ë“  Feature Group í˜„ì¬ ìƒíƒœ í™•ì¸:"
for fg in "${FEATURE_GROUPS[@]}"; do
    echo ""
    echo "ğŸ“Š $fg:"
    fs schema "$fg" --format table | head -10
done

# ì •ë¦¬
rm -f "$FEATURE_FILE"
```

### 2. ìŠ¤í‚¤ë§ˆ ì§„í™” ê´€ë¦¬ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# schema_evolution_manager.sh - Feature Group ìŠ¤í‚¤ë§ˆ ë²„ì „ ê´€ë¦¬

FEATURE_GROUP="$1"
EVOLUTION_DIR="schema_evolution"

if [ -z "$FEATURE_GROUP" ]; then
    echo "ì‚¬ìš©ë²•: $0 <feature-group-name>"
    exit 1
fi

echo "ğŸ“ˆ ìŠ¤í‚¤ë§ˆ ì§„í™” ê´€ë¦¬: $FEATURE_GROUP"
echo "ì§„í™” ë””ë ‰í† ë¦¬: $EVOLUTION_DIR"

# ì§„í™” ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p "$EVOLUTION_DIR/$FEATURE_GROUP"

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë°±ì—…
current_schema_file="$EVOLUTION_DIR/$FEATURE_GROUP/schema_$(date +%Y%m%d_%H%M%S).json"
echo "ğŸ’¾ í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë°±ì—… ì¤‘: $current_schema_file"

fs schema "$FEATURE_GROUP" --format json > "$current_schema_file"

if [ $? -eq 0 ]; then
    echo "âœ… ìŠ¤í‚¤ë§ˆ ë°±ì—… ì™„ë£Œ"
    
    # ìŠ¤í‚¤ë§ˆ ì§„í™” íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸
    history_file="$EVOLUTION_DIR/$FEATURE_GROUP/evolution_history.txt"
    
    current_feature_count=$(jq '.TotalFeatures' "$current_schema_file")
    
    echo "$(date '+%Y-%m-%d %H:%M:%S') | Features: $current_feature_count | File: $(basename $current_schema_file)" >> "$history_file"
    
    # ì§„í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ
    echo ""
    echo "ğŸ“š ìŠ¤í‚¤ë§ˆ ì§„í™” íˆìŠ¤í† ë¦¬:"
    if [ -f "$history_file" ]; then
        tail -10 "$history_file" | while read -r line; do
            echo "  $line"
        done
    else
        echo "  ì²« ë²ˆì§¸ ìŠ¤í‚¤ë§ˆ ë°±ì—…"
    fi
    
    # ìŠ¤í‚¤ë§ˆ ë³€ê²½ ê³„íš í…œí”Œë¦¿ ìƒì„±
    evolution_plan="$EVOLUTION_DIR/$FEATURE_GROUP/next_evolution_plan.json"
    
    if [ ! -f "$evolution_plan" ]; then
        echo ""
        echo "ğŸ“‹ ìŠ¤í‚¤ë§ˆ ì§„í™” ê³„íš í…œí”Œë¦¿ ìƒì„±: $evolution_plan"
        
        cat > "$evolution_plan" << 'EOF'
{
  "evolution_version": "v1.1",
  "description": "ë‹¤ìŒ ìŠ¤í‚¤ë§ˆ ì§„í™” ê³„íš",
  "planned_date": "YYYY-MM-DD",
  "features_to_add": [
    {
      "FeatureName": "new_feature_name",
      "FeatureType": "String|Integral|Fractional",
      "Description": "ìƒˆë¡œìš´ feature ì„¤ëª…",
      "rationale": "ì¶”ê°€í•˜ëŠ” ì´ìœ "
    }
  ],
  "impact_assessment": {
    "breaking_changes": false,
    "downstream_systems_affected": [],
    "rollback_plan": "ë¡¤ë°± ê³„íš ì„¤ëª…"
  },
  "testing_checklist": [
    "ìƒˆ featureë¡œ ë°ì´í„° ì…ë ¥ í…ŒìŠ¤íŠ¸",
    "ê¸°ì¡´ ì¿¼ë¦¬ ì˜í–¥ë„ í™•ì¸",
    "ML íŒŒì´í”„ë¼ì¸ í˜¸í™˜ì„± ê²€ì¦"
  ]
}
EOF
        echo "âœ… í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
        echo ""
        echo "ğŸ’¡ ì‚¬ìš©ë²•:"
        echo "  1. $evolution_plan íŒŒì¼ì„ í¸ì§‘í•˜ì—¬ ì§„í™” ê³„íš ìˆ˜ë¦½"
        echo "  2. ê³„íš íŒŒì¼ì—ì„œ features_to_add ë°°ì—´ì„ ì¶”ì¶œí•˜ì—¬ add-features ì‹¤í–‰"
        echo "  3. ì‹¤í–‰ í›„ ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ ë³€ê²½ ì‚¬í•­ ì¶”ì "
    fi
    
    # ì´ì „ ìŠ¤í‚¤ë§ˆì™€ ë¹„êµ (ë‘ ë²ˆì§¸ ì‹¤í–‰ë¶€í„°)
    previous_schemas=($(ls -t "$EVOLUTION_DIR/$FEATURE_GROUP"/schema_*.json 2>/dev/null | tail -n +2))
    
    if [ ${#previous_schemas[@]} -gt 0 ]; then
        previous_schema="${previous_schemas[0]}"
        echo ""
        echo "ğŸ”„ ì´ì „ ìŠ¤í‚¤ë§ˆì™€ ë¹„êµ:"
        echo "  í˜„ì¬: $current_feature_countê°œ features"
        
        previous_count=$(jq '.TotalFeatures' "$previous_schema")
        echo "  ì´ì „: $previous_countê°œ features"
        
        if [ "$current_feature_count" -gt "$previous_count" ]; then
            added_count=$((current_feature_count - previous_count))
            echo "  ğŸ“ˆ $added_countê°œ feature ì¶”ê°€ë¨"
            
            # ìƒˆë¡œ ì¶”ê°€ëœ featureë“¤ ì°¾ê¸°
            echo ""
            echo "ğŸ†• ìƒˆë¡œ ì¶”ê°€ëœ features:"
            
            # Pythonì„ ì‚¬ìš©í•œ ì°¨ì´ì  ë¶„ì„
            python3 << EOF
import json
import sys

try:
    with open('$current_schema_file', 'r') as f:
        current = json.load(f)
    with open('$previous_schema', 'r') as f:
        previous = json.load(f)
    
    current_features = {f['FeatureName']: f for f in current['FeatureDefinitions']}
    previous_features = {f['FeatureName']: f for f in previous['FeatureDefinitions']}
    
    new_features = set(current_features.keys()) - set(previous_features.keys())
    
    for feature_name in sorted(new_features):
        feature = current_features[feature_name]
        print(f"  + {feature_name} ({feature['FeatureType']})")
        if 'Description' in feature:
            print(f"    ì„¤ëª…: {feature['Description']}")

except Exception as e:
    print(f"ë¹„êµ ì¤‘ ì˜¤ë¥˜: {e}")
EOF
        elif [ "$current_feature_count" -eq "$previous_count" ]; then
            echo "  â¡ï¸  ë³€ê²½ ì—†ìŒ"
        fi
    fi
    
    # ìŠ¤í‚¤ë§ˆ ì •í•©ì„± ê²€ì‚¬
    echo ""
    echo "ğŸ” ìŠ¤í‚¤ë§ˆ ì •í•©ì„± ê²€ì‚¬:"
    
    # ì¤‘ë³µ feature ì´ë¦„ í™•ì¸
    duplicate_count=$(jq -r '.FeatureDefinitions[].FeatureName' "$current_schema_file" | sort | uniq -d | wc -l)
    if [ "$duplicate_count" -gt 0 ]; then
        echo "  âš ï¸  ì¤‘ë³µëœ feature ì´ë¦„ ë°œê²¬!"
        jq -r '.FeatureDefinitions[].FeatureName' "$current_schema_file" | sort | uniq -d | sed 's/^/    - /'
    else
        echo "  âœ… ì¤‘ë³µ feature ì—†ìŒ"
    fi
    
    # í•„ìˆ˜ feature í™•ì¸
    record_identifier=$(jq -r '.RecordIdentifierFeatureName' "$current_schema_file")
    event_time_feature=$(jq -r '.EventTimeFeatureName' "$current_schema_file")
    
    if [ "$record_identifier" != "null" ] && [ "$event_time_feature" != "null" ]; then
        echo "  âœ… í•„ìˆ˜ features êµ¬ì„±ë¨ (Record ID: $record_identifier, Event Time: $event_time_feature)"
    else
        echo "  âš ï¸  í•„ìˆ˜ feature ì„¤ì • í™•ì¸ í•„ìš”"
    fi
    
    # ìŠ¤í‚¤ë§ˆ ì§„í™” ê¶Œì¥ì‚¬í•­
    echo ""
    echo "ğŸ’¡ ìŠ¤í‚¤ë§ˆ ì§„í™” ê¶Œì¥ì‚¬í•­:"
    if [ "$current_feature_count" -gt 20 ]; then
        echo "  ğŸ“¦ Feature ìˆ˜ê°€ ë§ìŠµë‹ˆë‹¤ ($current_feature_countê°œ). ë…¼ë¦¬ì  ê·¸ë£¹í•‘ ê³ ë ¤í•´ë³´ì„¸ìš”."
    fi
    
    vector_features=$(jq '[.FeatureDefinitions[] | select(.CollectionType == "List")] | length' "$current_schema_file")
    if [ "$vector_features" -gt 5 ]; then
        echo "  ğŸ§® ë²¡í„° featureê°€ ë§ìŠµë‹ˆë‹¤ ($vector_featuresê°œ). ì°¨ì› ìµœì í™”ë¥¼ ê³ ë ¤í•´ë³´ì„¸ìš”."
    fi
    
    echo "  ğŸ“š ë³€ê²½ ì´ë ¥ì„ ë¬¸ì„œí™”í•˜ì—¬ íŒ€ê³¼ ê³µìœ í•˜ì„¸ìš”."
    echo "  ğŸ§ª ìƒˆ feature ì¶”ê°€ ì „ì—ëŠ” í•­ìƒ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ê²€ì¦í•˜ì„¸ìš”."
    
else
    echo "âŒ ìŠ¤í‚¤ë§ˆ ë°±ì—… ì‹¤íŒ¨"
    exit 1
fi

# ì •ë¦¬ ì‘ì—… (30ì¼ ì´ìƒ ëœ ë°±ì—… íŒŒì¼ ì •ë¦¬)
find "$EVOLUTION_DIR/$FEATURE_GROUP" -name "schema_*.json" -type f -mtime +30 -delete 2>/dev/null || true

echo ""
echo "ğŸ“ ìŠ¤í‚¤ë§ˆ ì§„í™” ê´€ë¦¬ ì™„ë£Œ"
echo "  ë°±ì—… ë””ë ‰í† ë¦¬: $EVOLUTION_DIR/$FEATURE_GROUP"
echo "  ìµœì‹  ìŠ¤í‚¤ë§ˆ: $current_schema_file"
echo "  ì§„í™” ê³„íš: $evolution_plan"
```

### 3. Feature í˜¸í™˜ì„± ê²€ì¦ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# feature_compatibility_validator.sh - ìƒˆ feature ì¶”ê°€ ì „ í˜¸í™˜ì„± ê²€ì¦

FEATURE_GROUP="$1"
NEW_FEATURES_FILE="$2"

if [ -z "$FEATURE_GROUP" ] || [ -z "$NEW_FEATURES_FILE" ]; then
    echo "ì‚¬ìš©ë²•: $0 <feature-group-name> <new-features-file>"
    exit 1
fi

echo "ğŸ”¬ Feature í˜¸í™˜ì„± ê²€ì¦ ì‹œì‘"
echo "Feature Group: $FEATURE_GROUP"
echo "ìƒˆ Features íŒŒì¼: $NEW_FEATURES_FILE"
echo ""

# ì„ì‹œ íŒŒì¼ë“¤
current_schema="/tmp/${FEATURE_GROUP}_current_schema.json"
validation_report="/tmp/validation_report_$(date +%Y%m%d_%H%M%S).txt"

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ê°€ì ¸ì˜¤ê¸°
echo "ğŸ“Š í˜„ì¬ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ ì¤‘..."
if ! fs schema "$FEATURE_GROUP" --format json > "$current_schema"; then
    echo "âŒ í˜„ì¬ ìŠ¤í‚¤ë§ˆë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
    exit 1
fi

# ìƒˆ features íŒŒì¼ ê²€ì¦
echo "ğŸ“ ìƒˆ features íŒŒì¼ ê²€ì¦ ì¤‘..."
if [ ! -f "$NEW_FEATURES_FILE" ]; then
    echo "âŒ ìƒˆ features íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: $NEW_FEATURES_FILE"
    exit 1
fi

# JSON ìœ íš¨ì„± ê²€ì‚¬
if ! jq empty "$NEW_FEATURES_FILE" 2>/dev/null; then
    echo "âŒ ìƒˆ features íŒŒì¼ì´ ìœ íš¨í•œ JSONì´ ì•„ë‹™ë‹ˆë‹¤"
    exit 1
fi

# Pythonì„ ì‚¬ìš©í•œ ìƒì„¸ í˜¸í™˜ì„± ê²€ì¦
python3 << EOF > "$validation_report"
import json
import sys
from datetime import datetime

print("ğŸ”¬ Feature í˜¸í™˜ì„± ê²€ì¦ ë¦¬í¬íŠ¸")
print("=" * 60)
print(f"ê²€ì¦ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
print(f"Feature Group: $FEATURE_GROUP")
print(f"ìƒˆ Features íŒŒì¼: $NEW_FEATURES_FILE")
print("")

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¡œë“œ
try:
    with open('$current_schema', 'r') as f:
        current_schema = json.load(f)
except Exception as e:
    print(f"âŒ í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¡œë“œ ì‹¤íŒ¨: {e}")
    sys.exit(1)

# ìƒˆ features ë¡œë“œ
try:
    with open('$NEW_FEATURES_FILE', 'r') as f:
        new_features = json.load(f)
except Exception as e:
    print(f"âŒ ìƒˆ features íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: {e}")
    sys.exit(1)

# ê¸°ì¡´ features ì •ë³´
existing_features = {f['FeatureName']: f for f in current_schema['FeatureDefinitions']}
existing_feature_names = set(existing_features.keys())

print(f"ğŸ“Š ê¸°ì¡´ Feature í˜„í™©")
print("-" * 30)
print(f"ì´ Feature ìˆ˜: {len(existing_features)}")
print(f"Record Identifier: {current_schema.get('RecordIdentifierFeatureName', 'N/A')}")
print(f"Event Time Feature: {current_schema.get('EventTimeFeatureName', 'N/A')}")

# ìƒˆ features ê²€ì¦
print(f"\nğŸ“ ìƒˆ Features ê²€ì¦")
print("-" * 30)

if not isinstance(new_features, list):
    print("âŒ ìƒˆ featuresëŠ” ë°°ì—´ í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤")
    sys.exit(1)

print(f"ì¶”ê°€ ì˜ˆì • Feature ìˆ˜: {len(new_features)}")

# ìƒì„¸ ê²€ì¦
validation_errors = []
validation_warnings = []
features_to_add = []
duplicate_features = []

for i, feature in enumerate(new_features):
    feature_name = feature.get('FeatureName')
    feature_type = feature.get('FeatureType')
    
    # í•„ìˆ˜ í•„ë“œ ê²€ì¦
    if not feature_name:
        validation_errors.append(f"Feature #{i+1}: FeatureNameì´ í•„ìš”í•©ë‹ˆë‹¤")
        continue
        
    if not feature_type:
        validation_errors.append(f"Feature '{feature_name}': FeatureTypeì´ í•„ìš”í•©ë‹ˆë‹¤")
        continue
    
    # FeatureType ìœ íš¨ì„± ê²€ì¦
    valid_types = ['String', 'Integral', 'Fractional']
    if feature_type not in valid_types:
        validation_errors.append(f"Feature '{feature_name}': ì˜ëª»ëœ FeatureType '{feature_type}'. ìœ íš¨í•œ ê°’: {valid_types}")
        continue
    
    # ì¤‘ë³µ ê²€ì‚¬
    if feature_name in existing_feature_names:
        duplicate_features.append(feature_name)
        continue
    
    # CollectionType ê²€ì¦
    collection_type = feature.get('CollectionType')
    if collection_type:
        if collection_type not in ['List', 'Set']:
            validation_errors.append(f"Feature '{feature_name}': ì˜ëª»ëœ CollectionType '{collection_type}'")
        elif collection_type == 'List':
            # VectorConfig ê²€ì¦
            collection_config = feature.get('CollectionConfig', {})
            vector_config = collection_config.get('VectorConfig', {})
            dimension = vector_config.get('Dimension')
            
            if not dimension or not isinstance(dimension, int) or dimension <= 0:
                validation_errors.append(f"Feature '{feature_name}': List íƒ€ì…ì€ ìœ íš¨í•œ Dimensionì´ í•„ìš”í•©ë‹ˆë‹¤")
    
    # ì´ë¦„ ê·œì¹™ ê²€ì¦
    if not feature_name.replace('_', '').replace('-', '').isalnum():
        validation_warnings.append(f"Feature '{feature_name}': ì´ë¦„ì— íŠ¹ìˆ˜ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤")
    
    if len(feature_name) > 64:
        validation_errors.append(f"Feature '{feature_name}': ì´ë¦„ì´ ë„ˆë¬´ ê¹ë‹ˆë‹¤ (ìµœëŒ€ 64ì)")
    
    features_to_add.append(feature)

# ê²€ì¦ ê²°ê³¼ ì¶œë ¥
print(f"\nğŸ“‹ ê²€ì¦ ê²°ê³¼")
print("-" * 30)

if validation_errors:
    print(f"âŒ ê²€ì¦ ì˜¤ë¥˜ ({len(validation_errors)}ê°œ):")
    for error in validation_errors:
        print(f"  - {error}")
    print("")

if validation_warnings:
    print(f"âš ï¸  ê²€ì¦ ê²½ê³  ({len(validation_warnings)}ê°œ):")
    for warning in validation_warnings:
        print(f"  - {warning}")
    print("")

if duplicate_features:
    print(f"ğŸ”„ ì¤‘ë³µëœ Features ({len(duplicate_features)}ê°œ, ìŠ¤í‚µë¨):")
    for dup in duplicate_features:
        existing_type = existing_features[dup]['FeatureType']
        print(f"  - {dup} (ê¸°ì¡´: {existing_type})")
    print("")

if features_to_add:
    print(f"âœ… ì¶”ê°€ ê°€ëŠ¥í•œ Features ({len(features_to_add)}ê°œ):")
    for feature in features_to_add:
        fname = feature['FeatureName']
        ftype = feature['FeatureType']
        collection = feature.get('CollectionType', '')
        desc = feature.get('Description', '')
        
        collection_info = f" [{collection}]" if collection else ""
        desc_info = f" - {desc}" if desc else ""
        
        print(f"  + {fname} ({ftype}{collection_info}){desc_info}")
    print("")

# í˜¸í™˜ì„± ë¶„ì„
print(f"ğŸ” í˜¸í™˜ì„± ë¶„ì„")
print("-" * 30)

# Feature ê°œìˆ˜ ë¶„ì„
total_after_addition = len(existing_features) + len(features_to_add)
if total_after_addition > 50:
    print(f"âš ï¸  ì¶”ê°€ í›„ ì´ Feature ìˆ˜ê°€ ë§ìŠµë‹ˆë‹¤ ({total_after_addition}ê°œ)")
    print("   â†’ Feature Group ë¶„í• ì„ ê³ ë ¤í•´ë³´ì„¸ìš”")

# ë²¡í„° feature ë¶„ì„
vector_features_existing = sum(1 for f in existing_features.values() if f.get('CollectionType') == 'List')
vector_features_new = sum(1 for f in features_to_add if f.get('CollectionType') == 'List')
total_vectors = vector_features_existing + vector_features_new

if total_vectors > 10:
    print(f"âš ï¸  ë²¡í„° Featureê°€ ë§ìŠµë‹ˆë‹¤ ({total_vectors}ê°œ)")
    print("   â†’ ìŠ¤í† ë¦¬ì§€ ë° ì¿¼ë¦¬ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤")

# íƒ€ì… ë¶„í¬ ë¶„ì„
type_distribution = {}
for feature in list(existing_features.values()) + features_to_add:
    ftype = feature.get('FeatureType', 'Unknown')
    type_distribution[ftype] = type_distribution.get(ftype, 0) + 1

print(f"\nğŸ“Š Feature Type ë¶„í¬ (ì¶”ê°€ í›„):")
for ftype, count in type_distribution.items():
    print(f"  {ftype}: {count}ê°œ")

# ê¶Œì¥ì‚¬í•­
print(f"\nğŸ’¡ ê¶Œì¥ì‚¬í•­")
print("-" * 30)

if validation_errors:
    print("1. ê²€ì¦ ì˜¤ë¥˜ë¥¼ ëª¨ë‘ ìˆ˜ì •í•œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”")
    sys.exit(1)  # ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ ì‹¤íŒ¨ë¡œ ì¢…ë£Œ
else:
    print("âœ… í˜¸í™˜ì„± ê²€ì¦ í†µê³¼!")
    
    if validation_warnings:
        print("2. ê²½ê³  ì‚¬í•­ì„ ê²€í† í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•˜ì„¸ìš”")
    
    print("3. í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ê²€ì¦í•˜ì„¸ìš”")
    print("4. ìƒˆ feature ì¶”ê°€ í›„ ìŠ¤í‚¤ë§ˆ ë°±ì—…ì„ ê¶Œì¥í•©ë‹ˆë‹¤")
    
    if len(features_to_add) > 0:
        print("\nğŸš€ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ Featureë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:")
        print(f"   fs add-features $FEATURE_GROUP $NEW_FEATURES_FILE --dry-run")
        print(f"   fs add-features $FEATURE_GROUP $NEW_FEATURES_FILE")
EOF

# ê²€ì¦ ë¦¬í¬íŠ¸ í‘œì‹œ
echo ""
cat "$validation_report"

# ë¦¬í¬íŠ¸ ì €ì¥ ì—¬ë¶€ í™•ì¸
echo ""
echo "ğŸ“„ ê²€ì¦ ë¦¬í¬íŠ¸ë¥¼ ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
read -r save_report

if [[ $save_report =~ ^[Yy]$ ]]; then
    report_dir="validation_reports"
    mkdir -p "$report_dir"
    
    final_report="$report_dir/${FEATURE_GROUP}_compatibility_$(date +%Y%m%d_%H%M%S).txt"
    cp "$validation_report" "$final_report"
    
    echo "âœ… ê²€ì¦ ë¦¬í¬íŠ¸ ì €ì¥ë¨: $final_report"
fi

# ì •ë¦¬
rm -f "$current_schema" "$validation_report"

echo ""
echo "ğŸ”¬ í˜¸í™˜ì„± ê²€ì¦ ì™„ë£Œ"
```

### 4. ìŠ¤ë§ˆíŠ¸ Feature ì¶”ì²œ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# smart_feature_recommender.sh - ML ê¸°ë°˜ ìƒˆ feature ì¶”ì²œ

FEATURE_GROUP="$1"
RECOMMENDATION_TYPE="${2:-analytics}"  # analytics, ml, business

if [ -z "$FEATURE_GROUP" ]; then
    echo "ì‚¬ìš©ë²•: $0 <feature-group-name> [recommendation-type]"
    echo "recommendation-type: analytics, ml, business"
    exit 1
fi

echo "ğŸ¤– ìŠ¤ë§ˆíŠ¸ Feature ì¶”ì²œ ì‹œìŠ¤í…œ"
echo "Feature Group: $FEATURE_GROUP"
echo "ì¶”ì²œ ìœ í˜•: $RECOMMENDATION_TYPE"
echo ""

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¶„ì„
current_schema="/tmp/${FEATURE_GROUP}_analysis.json"
echo "ğŸ“Š í˜„ì¬ Feature Group ë¶„ì„ ì¤‘..."

if ! fs schema "$FEATURE_GROUP" --format json > "$current_schema"; then
    echo "âŒ Feature Group ìŠ¤í‚¤ë§ˆë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
    exit 1
fi

# Python ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ
python3 << EOF
import json
import re
from datetime import datetime
from collections import defaultdict

# ì¶”ì²œ í…œí”Œë¦¿
RECOMMENDATION_TEMPLATES = {
    'analytics': {
        'temporal_features': [
            {
                "FeatureName": "created_timestamp",
                "FeatureType": "Fractional",
                "Description": "ë ˆì½”ë“œ ìƒì„± ì‹œê°„ (Unix timestamp)",
                "rationale": "ì‹œê³„ì—´ ë¶„ì„ ë° íŠ¸ë Œë“œ íŒŒì•…ì— í•„ìˆ˜"
            },
            {
                "FeatureName": "last_updated_date",
                "FeatureType": "String", 
                "Description": "ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ë‚ ì§œ (YYYY-MM-DD)",
                "rationale": "ë°ì´í„° ì‹ ì„ ë„ ë° ì—…ë°ì´íŠ¸ íŒ¨í„´ ë¶„ì„"
            },
            {
                "FeatureName": "hour_of_day",
                "FeatureType": "Integral",
                "Description": "í•˜ë£¨ ì¤‘ ì‹œê°„ (0-23)",
                "rationale": "ì‹œê°„ë³„ íŒ¨í„´ ë¶„ì„"
            }
        ],
        'quality_features': [
            {
                "FeatureName": "data_quality_score",
                "FeatureType": "Fractional", 
                "Description": "ë°ì´í„° í’ˆì§ˆ ì ìˆ˜ (0.0-1.0)",
                "rationale": "ë°ì´í„° ì‹ ë¢°ì„± í‰ê°€ ë° í•„í„°ë§"
            },
            {
                "FeatureName": "completeness_ratio",
                "FeatureType": "Fractional",
                "Description": "í•„ë“œ ì™„ì„±ë„ ë¹„ìœ¨",
                "rationale": "ëˆ„ë½ ë°ì´í„° ë¶„ì„"
            }
        ],
        'aggregation_features': [
            {
                "FeatureName": "daily_count",
                "FeatureType": "Integral",
                "Description": "ì¼ë³„ ë°œìƒ íšŸìˆ˜",
                "rationale": "í™œë™ëŸ‰ ì¶”ì´ ë¶„ì„"
            },
            {
                "FeatureName": "cumulative_value",
                "FeatureType": "Fractional",
                "Description": "ëˆ„ì  ê°’",
                "rationale": "ì„±ì¥ ë° ëˆ„ì  íŒ¨í„´ ë¶„ì„"
            }
        ]
    },
    'ml': {
        'embedding_features': [
            {
                "FeatureName": "text_embeddings",
                "FeatureType": "String",
                "CollectionType": "List",
                "CollectionConfig": {
                    "VectorConfig": {"Dimension": 512}
                },
                "Description": "í…ìŠ¤íŠ¸ ì„ë² ë”© ë²¡í„°",
                "rationale": "ìì—°ì–´ ì²˜ë¦¬ ëª¨ë¸ì˜ ì…ë ¥ feature"
            },
            {
                "FeatureName": "item_embeddings", 
                "FeatureType": "String",
                "CollectionType": "List",
                "CollectionConfig": {
                    "VectorConfig": {"Dimension": 256}
                },
                "Description": "ì•„ì´í…œ ì„ë² ë”© ë²¡í„°",
                "rationale": "ì¶”ì²œ ì‹œìŠ¤í…œ ë° ìœ ì‚¬ë„ ê³„ì‚°"
            }
        ],
        'engineered_features': [
            {
                "FeatureName": "interaction_score",
                "FeatureType": "Fractional",
                "Description": "ìƒí˜¸ì‘ìš© ì ìˆ˜",
                "rationale": "ML ëª¨ë¸ì˜ ì˜ˆì¸¡ë ¥ í–¥ìƒ"
            },
            {
                "FeatureName": "anomaly_score",
                "FeatureType": "Fractional", 
                "Description": "ì´ìƒì¹˜ ì ìˆ˜",
                "rationale": "ì´ìƒ íƒì§€ ëª¨ë¸ í•™ìŠµ"
            },
            {
                "FeatureName": "feature_importance_weights",
                "FeatureType": "String",
                "CollectionType": "List", 
                "CollectionConfig": {
                    "VectorConfig": {"Dimension": 100}
                },
                "Description": "Feature ì¤‘ìš”ë„ ê°€ì¤‘ì¹˜",
                "rationale": "ë™ì  feature selection"
            }
        ],
        'prediction_features': [
            {
                "FeatureName": "predicted_value",
                "FeatureType": "Fractional",
                "Description": "ì˜ˆì¸¡ê°’",
                "rationale": "ëª¨ë¸ ì¶œë ¥ ì €ì¥ ë° ë¹„êµ"
            },
            {
                "FeatureName": "prediction_confidence",
                "FeatureType": "Fractional",
                "Description": "ì˜ˆì¸¡ ì‹ ë¢°ë„",
                "rationale": "ì˜ˆì¸¡ í’ˆì§ˆ í‰ê°€"
            }
        ]
    },
    'business': {
        'kpi_features': [
            {
                "FeatureName": "conversion_rate",
                "FeatureType": "Fractional",
                "Description": "ì „í™˜ìœ¨",
                "rationale": "ë¹„ì¦ˆë‹ˆìŠ¤ ì„±ê³¼ ì¸¡ì •"
            },
            {
                "FeatureName": "lifetime_value",
                "FeatureType": "Fractional", 
                "Description": "ê³ ê° ìƒì•  ê°€ì¹˜",
                "rationale": "ê³ ê° ì„¸ë¶„í™” ë° ë§ˆì¼€íŒ… ìµœì í™”"
            },
            {
                "FeatureName": "retention_score",
                "FeatureType": "Fractional",
                "Description": "ê³ ê° ìœ ì§€ ì ìˆ˜", 
                "rationale": "ì´íƒˆ ì˜ˆì¸¡ ëª¨ë¸ ê°œë°œ"
            }
        ],
        'segmentation_features': [
            {
                "FeatureName": "customer_segment",
                "FeatureType": "String",
                "Description": "ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ ë¶„ë¥˜",
                "rationale": "íƒ€ê²Ÿ ë§ˆì¼€íŒ… ë° ê°œì¸í™”"
            },
            {
                "FeatureName": "engagement_level",
                "FeatureType": "String", 
                "Description": "ì°¸ì—¬ë„ ìˆ˜ì¤€ (High/Medium/Low)",
                "rationale": "ì°¸ì—¬ë„ ê¸°ë°˜ ì „ëµ ìˆ˜ë¦½"
            }
        ],
        'financial_features': [
            {
                "FeatureName": "revenue_contribution",
                "FeatureType": "Fractional",
                "Description": "ë§¤ì¶œ ê¸°ì—¬ë„",
                "rationale": "ìˆ˜ìµì„± ë¶„ì„"
            },
            {
                "FeatureName": "cost_per_acquisition",
                "FeatureType": "Fractional",
                "Description": "ê³ ê° íšë“ ë¹„ìš©",
                "rationale": "ë§ˆì¼€íŒ… ROI ìµœì í™”"
            }
        ]
    }
}

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¡œë“œ
with open('$current_schema', 'r') as f:
    schema = json.load(f)

existing_features = {f['FeatureName'].lower() for f in schema['FeatureDefinitions']}
feature_types = defaultdict(int)
has_vector_features = False

# ê¸°ì¡´ feature ë¶„ì„
for feature in schema['FeatureDefinitions']:
    feature_types[feature['FeatureType']] += 1
    if feature.get('CollectionType') == 'List':
        has_vector_features = True

print(f"ğŸ§  ìŠ¤ë§ˆíŠ¸ Feature ì¶”ì²œ ë¦¬í¬íŠ¸")
print(f"=" * 60)
print(f"ìƒì„± ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
print(f"Feature Group: $FEATURE_GROUP")
print(f"ì¶”ì²œ ìœ í˜•: $RECOMMENDATION_TYPE")
print(f"")

print(f"ğŸ“Š í˜„ì¬ Feature ë¶„ì„")
print(f"-" * 30)
print(f"ì´ Feature ìˆ˜: {len(existing_features)}")
print(f"Feature Type ë¶„í¬:")
for ftype, count in feature_types.items():
    print(f"  - {ftype}: {count}ê°œ")
print(f"ë²¡í„° Feature ì¡´ì¬: {'ì˜ˆ' if has_vector_features else 'ì•„ë‹ˆì˜¤'}")
print("")

# ì¶”ì²œ ìƒì„±
recommendations = RECOMMENDATION_TEMPLATES.get('$RECOMMENDATION_TYPE', {})
if not recommendations:
    print("âŒ ì˜ëª»ëœ ì¶”ì²œ ìœ í˜•ì…ë‹ˆë‹¤")
    exit(1)

recommended_features = []
recommendation_reasons = []

print(f"ğŸ¯ ì¶”ì²œ Feature (ìœ í˜•: $RECOMMENDATION_TYPE)")
print(f"-" * 30)

for category, features in recommendations.items():
    category_name = category.replace('_', ' ').title()
    print(f"\nğŸ“‚ {category_name}:")
    
    category_recommendations = []
    for feature in features:
        feature_name_lower = feature['FeatureName'].lower()
        
        # ì´ë¯¸ ì¡´ì¬í•˜ëŠ” featureëŠ” ì œì™¸
        if feature_name_lower not in existing_features:
            # ìœ ì‚¬í•œ ì´ë¦„ì˜ featureê°€ ìˆëŠ”ì§€ í™•ì¸
            similar_exists = any(
                feature_name_lower in existing.lower() or existing.lower() in feature_name_lower 
                for existing in existing_features
            )
            
            if not similar_exists:
                category_recommendations.append(feature)
                recommended_features.append(feature)
                
                print(f"  + {feature['FeatureName']} ({feature['FeatureType']})")
                if feature.get('CollectionType'):
                    print(f"    Collection: {feature['CollectionType']}")
                print(f"    ì„¤ëª…: {feature['Description']}")
                print(f"    ê·¼ê±°: {feature['rationale']}")
                print("")
    
    if not category_recommendations:
        print(f"  â„¹ï¸ ì´ ì¹´í…Œê³ ë¦¬ì˜ featureë“¤ì€ ì´ë¯¸ ì¡´ì¬í•˜ê±°ë‚˜ ìœ ì‚¬í•©ë‹ˆë‹¤")

# ê°œë³„í™”ëœ ì¶”ì²œ (feature ì´ë¦„ íŒ¨í„´ ê¸°ë°˜)
print(f"\nğŸ¨ ê°œë³„í™”ëœ ì¶”ì²œ (ê¸°ì¡´ íŒ¨í„´ ê¸°ë°˜)")
print(f"-" * 40)

# ê¸°ì¡´ feature ì´ë¦„ì—ì„œ íŒ¨í„´ ì¶”ì¶œ
name_patterns = []
for feature in schema['FeatureDefinitions']:
    name = feature['FeatureName'].lower()
    
    # ê³µí†µ íŒ¨í„´ ì°¾ê¸°
    if 'user' in name or 'customer' in name:
        if 'user_satisfaction_score' not in [f['FeatureName'].lower() for f in recommended_features]:
            recommended_features.append({
                "FeatureName": "user_satisfaction_score",
                "FeatureType": "Fractional",
                "Description": "ì‚¬ìš©ì ë§Œì¡±ë„ ì ìˆ˜",
                "rationale": "ê¸°ì¡´ ì‚¬ìš©ì ê´€ë ¨ featureë“¤ê³¼ ì—°ê³„í•œ ë§Œì¡±ë„ ì¸¡ì •"
            })
    
    if 'price' in name or 'cost' in name or 'amount' in name:
        if 'price_elasticity' not in [f['FeatureName'].lower() for f in recommended_features]:
            recommended_features.append({
                "FeatureName": "price_elasticity",
                "FeatureType": "Fractional", 
                "Description": "ê°€ê²© íƒ„ë ¥ì„± ì§€ìˆ˜",
                "rationale": "ê°€ê²© ê´€ë ¨ featureë“¤ê³¼ ì—°ê³„í•œ íƒ„ë ¥ì„± ë¶„ì„"
            })
    
    if 'time' in name or 'date' in name:
        if 'time_since_last_activity' not in [f['FeatureName'].lower() for f in recommended_features]:
            recommended_features.append({
                "FeatureName": "time_since_last_activity",
                "FeatureType": "Fractional",
                "Description": "ë§ˆì§€ë§‰ í™œë™ ì´í›„ ê²½ê³¼ ì‹œê°„ (ì‹œê°„ ë‹¨ìœ„)",
                "rationale": "ì‹œê°„ ê´€ë ¨ featureë“¤ê³¼ ì—°ê³„í•œ í™œë™ íŒ¨í„´ ë¶„ì„"
            })

# ìµœì¢… ì¶”ì²œ ìš”ì•½
print(f"\nğŸ“‹ ì¶”ì²œ ìš”ì•½")
print(f"-" * 30)
print(f"ì´ ì¶”ì²œ Feature ìˆ˜: {len(recommended_features)}")

if not recommended_features:
    print("í˜„ì¬ Feature Groupì´ ì´ë¯¸ ì¶©ë¶„íˆ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.")
    print("íŠ¹ë³„í•œ ìš”êµ¬ì‚¬í•­ì´ ìˆë‹¤ë©´ ìˆ˜ë™ìœ¼ë¡œ featureë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.")
else:
    # ì¶”ì²œ featureë“¤ì„ JSON íŒŒì¼ë¡œ ìƒì„±
    output_file = f"recommended_features_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    
    # Descriptionê³¼ rationale ì œê±°í•˜ê³  ìˆœìˆ˜ feature definitionë§Œ ë‚¨ê¹€
    clean_features = []
    for feature in recommended_features:
        clean_feature = {
            "FeatureName": feature["FeatureName"],
            "FeatureType": feature["FeatureType"]
        }
        if "CollectionType" in feature:
            clean_feature["CollectionType"] = feature["CollectionType"]
        if "CollectionConfig" in feature:
            clean_feature["CollectionConfig"] = feature["CollectionConfig"]
        if "Description" in feature:
            clean_feature["Description"] = feature["Description"]
        
        clean_features.append(clean_feature)
    
    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(clean_features, f, indent=2, ensure_ascii=False)
    
    print(f"âœ… ì¶”ì²œ feature íŒŒì¼ ìƒì„±ë¨: {output_file}")
    print(f"")
    print(f"ğŸš€ ë‹¤ìŒ ë‹¨ê³„:")
    print(f"1. ì¶”ì²œ ë‚´ìš©ì„ ê²€í† í•˜ê³  í•„ìš”ì— ë”°ë¼ ìˆ˜ì •")
    print(f"2. í˜¸í™˜ì„± ê²€ì¦: feature_compatibility_validator.sh $FEATURE_GROUP {output_file}")
    print(f"3. Feature ì¶”ê°€: fs add-features $FEATURE_GROUP {output_file} --dry-run")
    print(f"4. ì‹¤ì œ ì ìš©: fs add-features $FEATURE_GROUP {output_file}")

EOF

echo ""
echo "ğŸ¤– ìŠ¤ë§ˆíŠ¸ ì¶”ì²œ ì™„ë£Œ"

# ì •ë¦¬
rm -f "$current_schema"
```

### 5. A/B í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì ì§„ì  Feature ë¡¤ì•„ì›ƒ

```bash
#!/bin/bash
# progressive_feature_rollout.sh - ì ì§„ì  feature ë°°í¬ ì‹œìŠ¤í…œ

FEATURE_GROUP="$1"
FEATURES_FILE="$2"
ROLLOUT_STRATEGY="${3:-canary}"  # canary, blue-green, percentage

if [ -z "$FEATURE_GROUP" ] || [ -z "$FEATURES_FILE" ]; then
    echo "ì‚¬ìš©ë²•: $0 <feature-group-name> <features-file> [rollout-strategy]"
    echo "rollout-strategy: canary, blue-green, percentage"
    exit 1
fi

echo "ğŸš€ ì ì§„ì  Feature ë¡¤ì•„ì›ƒ ì‹œìŠ¤í…œ"
echo "Feature Group: $FEATURE_GROUP"
echo "Features íŒŒì¼: $FEATURES_FILE"
echo "ë¡¤ì•„ì›ƒ ì „ëµ: $ROLLOUT_STRATEGY"
echo ""

# ë¡¤ì•„ì›ƒ ë””ë ‰í† ë¦¬ ìƒì„±
rollout_dir="feature_rollouts/$(date +%Y%m%d_%H%M%S)_${FEATURE_GROUP}"
mkdir -p "$rollout_dir"

# í˜„ì¬ ìƒíƒœ ë°±ì—…
echo "ğŸ’¾ í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë°±ì—… ì¤‘..."
fs schema "$FEATURE_GROUP" --format json > "$rollout_dir/schema_before.json"

# ë¡¤ì•„ì›ƒ ê³„íš ìƒì„±
rollout_plan="$rollout_dir/rollout_plan.json"

cat > "$rollout_plan" << EOF
{
  "rollout_id": "$(date +%Y%m%d_%H%M%S)",
  "feature_group": "$FEATURE_GROUP", 
  "features_file": "$FEATURES_FILE",
  "strategy": "$ROLLOUT_STRATEGY",
  "start_time": "$(date -Iseconds)",
  "stages": [],
  "current_stage": 0,
  "status": "planned"
}
EOF

case "$ROLLOUT_STRATEGY" in
    "canary")
        echo "ğŸ¦ Canary ë¡¤ì•„ì›ƒ ì „ëµ ì ìš©"
        echo ""
        
        # Stage 1: ê²€ì¦ë§Œ (ì‹¤ì œ ë°°í¬ ì•ˆí•¨)
        echo "ğŸ“‹ Stage 1: Canary ê²€ì¦"
        echo "  - í˜¸í™˜ì„± ê²€ì¦"
        echo "  - Dry-run í…ŒìŠ¤íŠ¸" 
        echo "  - ì˜í–¥ë„ ë¶„ì„"
        
        # í˜¸í™˜ì„± ê²€ì¦
        if ./feature_compatibility_validator.sh "$FEATURE_GROUP" "$FEATURES_FILE"; then
            echo "  âœ… í˜¸í™˜ì„± ê²€ì¦ í†µê³¼"
        else
            echo "  âŒ í˜¸í™˜ì„± ê²€ì¦ ì‹¤íŒ¨ - ë¡¤ì•„ì›ƒ ì¤‘ë‹¨"
            exit 1
        fi
        
        # Dry-run
        if fs add-features "$FEATURE_GROUP" "$FEATURES_FILE" --dry-run; then
            echo "  âœ… Dry-run í…ŒìŠ¤íŠ¸ í†µê³¼"
        else
            echo "  âŒ Dry-run í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ - ë¡¤ì•„ì›ƒ ì¤‘ë‹¨"
            exit 1
        fi
        
        echo ""
        echo "â¸ï¸  Canary ê²€ì¦ ì™„ë£Œ. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
        read -r continue_rollout
        
        if [[ ! $continue_rollout =~ ^[Yy]$ ]]; then
            echo "ğŸ›‘ ë¡¤ì•„ì›ƒ ì·¨ì†Œë¨"
            exit 0
        fi
        
        # Stage 2: ì‹¤ì œ ë°°í¬
        echo "ğŸ“‹ Stage 2: í”„ë¡œë•ì…˜ ë°°í¬"
        
        if fs add-features "$FEATURE_GROUP" "$FEATURES_FILE"; then
            echo "  âœ… Feature ì¶”ê°€ ì„±ê³µ"
            
            # ë°°í¬ í›„ ê²€ì¦
            echo "  ğŸ” ë°°í¬ í›„ ê²€ì¦ ì¤‘..."
            fs schema "$FEATURE_GROUP" --format json > "$rollout_dir/schema_after.json"
            
            # ë³€ê²½ ì‚¬í•­ í™•ì¸
            python3 << 'EOF'
import json

with open('$rollout_dir/schema_before.json', 'r') as f:
    before = json.load(f)
with open('$rollout_dir/schema_after.json', 'r') as f:
    after = json.load(f)

before_features = {f['FeatureName'] for f in before['FeatureDefinitions']}
after_features = {f['FeatureName'] for f in after['FeatureDefinitions']}

new_features = after_features - before_features
print(f"  ğŸ“ˆ ì¶”ê°€ëœ features: {len(new_features)}ê°œ")
for feature in sorted(new_features):
    print(f"    + {feature}")
EOF
            
            echo "  âœ… Canary ë¡¤ì•„ì›ƒ ì„±ê³µ ì™„ë£Œ"
        else
            echo "  âŒ Feature ì¶”ê°€ ì‹¤íŒ¨"
            exit 1
        fi
        ;;
        
    "blue-green")
        echo "ğŸ”µğŸŸ¢ Blue-Green ë¡¤ì•„ì›ƒ ì „ëµ"
        echo "âš ï¸  ì°¸ê³ : SageMaker Feature StoreëŠ” Blue-Greenì„ ì§ì ‘ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
        echo "ëŒ€ì‹  Feature ì¶”ê°€ ì „í›„ ë¹„êµë¥¼ í†µí•œ ì•ˆì „í•œ ë°°í¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤."
        echo ""
        
        # Green (ìƒˆ ë²„ì „) ì¤€ë¹„
        echo "ğŸ“‹ Green í™˜ê²½ ì¤€ë¹„"
        
        # ë°±ì—… Feature Group ìƒì„±ì€ ë¹„ìš©ì´ ë§ì´ ë“¤ë¯€ë¡œ, ë©”íƒ€ë°ì´í„°ë¡œ ì‹œë®¬ë ˆì´ì…˜
        green_metadata="$rollout_dir/green_environment.json"
        
        # í˜„ì¬ schemaì— ìƒˆ features ì¶”ê°€í•œ ì‹œë®¬ë ˆì´ì…˜
        python3 << 'EOF'
import json

# í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¡œë“œ
with open('$rollout_dir/schema_before.json', 'r') as f:
    current_schema = json.load(f)

# ìƒˆ features ë¡œë“œ  
with open('$FEATURES_FILE', 'r') as f:
    new_features = json.load(f)

# Green í™˜ê²½ ìŠ¤í‚¤ë§ˆ ì‹œë®¬ë ˆì´ì…˜
green_schema = current_schema.copy()
green_schema['FeatureDefinitions'].extend(new_features)
green_schema['TotalFeatures'] = len(green_schema['FeatureDefinitions'])

# Green ë©”íƒ€ë°ì´í„° ì €ì¥
green_metadata = {
    "environment": "green",
    "simulated_schema": green_schema,
    "deployment_time": "$(date -Iseconds)",
    "rollback_available": True
}

with open('$rollout_dir/green_environment.json', 'w') as f:
    json.dump(green_metadata, f, indent=2, ensure_ascii=False, default=str)

print("  âœ… Green í™˜ê²½ ë©”íƒ€ë°ì´í„° ì¤€ë¹„ ì™„ë£Œ")
print(f"  ğŸ“Š ì˜ˆìƒ total features: {green_schema['TotalFeatures']}")
EOF
        
        echo ""
        echo "â¸ï¸  Green í™˜ê²½ìœ¼ë¡œ ì „í™˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
        read -r switch_to_green
        
        if [[ ! $switch_to_green =~ ^[Yy]$ ]]; then
            echo "ğŸ›‘ Blue-Green ë¡¤ì•„ì›ƒ ì·¨ì†Œë¨"
            exit 0
        fi
        
        # Greenìœ¼ë¡œ ì „í™˜ (ì‹¤ì œ Feature ì¶”ê°€)
        echo "ğŸ“‹ Green í™˜ê²½ìœ¼ë¡œ ì „í™˜"
        
        if fs add-features "$FEATURE_GROUP" "$FEATURES_FILE"; then
            echo "  âœ… Green í™˜ê²½ ë°°í¬ ì„±ê³µ"
            
            # ìƒˆ í™˜ê²½ ìƒíƒœ ì €ì¥
            fs schema "$FEATURE_GROUP" --format json > "$rollout_dir/green_deployed.json"
            
            echo "  ğŸ” íŠ¸ë˜í”½ ì „í™˜ ì™„ë£Œ"
            echo "  âœ… Blue-Green ë¡¤ì•„ì›ƒ ì™„ë£Œ"
        else
            echo "  âŒ Green í™˜ê²½ ë°°í¬ ì‹¤íŒ¨"
            exit 1
        fi
        ;;
        
    "percentage")
        echo "ğŸ“Š Percentage ê¸°ë°˜ ì ì§„ì  ë¡¤ì•„ì›ƒ"
        echo "âš ï¸  ì°¸ê³ : ì´ëŠ” Feature ì¶”ê°€ë¥¼ ë‹¨ê³„ë³„ë¡œ ì§„í–‰í•˜ëŠ” ì‹œë®¬ë ˆì´ì…˜ì…ë‹ˆë‹¤."
        echo ""
        
        # Featuresë¥¼ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ê¸°
        total_features=$(jq length "$FEATURES_FILE")
        
        if [ "$total_features" -lt 2 ]; then
            echo "ğŸ”„ Featureê°€ ì ì–´ì„œ ì „ì²´ ë°°í¬ë¡œ ì§„í–‰í•©ë‹ˆë‹¤"
            fs add-features "$FEATURE_GROUP" "$FEATURES_FILE"
        else
            echo "ğŸ“Š $total_featuresê°œ featuresë¥¼ ë‹¨ê³„ë³„ë¡œ ë°°í¬í•©ë‹ˆë‹¤"
            
            # 20%, 50%, 100% ë‹¨ê³„ë¡œ ë°°í¬
            stages=(20 50 100)
            
            for stage_percent in "${stages[@]}"; do
                features_count=$(( (total_features * stage_percent) / 100 ))
                if [ $features_count -eq 0 ]; then
                    features_count=1
                fi
                
                echo ""
                echo "ğŸ“‹ Stage: ${stage_percent}% ($features_countê°œ features)"
                
                # í•´ë‹¹ ë‹¨ê³„ì˜ featuresë§Œ ì¶”ì¶œ
                stage_features="$rollout_dir/stage_${stage_percent}_features.json"
                jq ".[0:$features_count]" "$FEATURES_FILE" > "$stage_features"
                
                echo "  ğŸš€ ${stage_percent}% ë°°í¬ ì‹œì‘..."
                
                if fs add-features "$FEATURE_GROUP" "$stage_features"; then
                    echo "  âœ… ${stage_percent}% ë°°í¬ ì„±ê³µ"
                    
                    # ê° ë‹¨ê³„ í›„ ìƒíƒœ ì €ì¥
                    fs schema "$FEATURE_GROUP" --format json > "$rollout_dir/schema_stage_${stage_percent}.json"
                    
                    if [ "$stage_percent" -lt 100 ]; then
                        echo "  â¸ï¸  ë‹¤ìŒ ë‹¨ê³„ë¡œ ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
                        read -r continue_next_stage
                        
                        if [[ ! $continue_next_stage =~ ^[Yy]$ ]]; then
                            echo "ğŸ›‘ ${stage_percent}%ì—ì„œ ë¡¤ì•„ì›ƒ ì¤‘ë‹¨ë¨"
                            break
                        fi
                    fi
                else
                    echo "  âŒ ${stage_percent}% ë°°í¬ ì‹¤íŒ¨"
                    exit 1
                fi
            done
            
            echo "  âœ… ì ì§„ì  ë¡¤ì•„ì›ƒ ì™„ë£Œ"
        fi
        ;;
        
    *)
        echo "âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¡¤ì•„ì›ƒ ì „ëµ: $ROLLOUT_STRATEGY"
        echo "ì§€ì› ì „ëµ: canary, blue-green, percentage"
        exit 1
        ;;
esac

# ë¡¤ì•„ì›ƒ ì™„ë£Œ ë¦¬í¬íŠ¸
echo ""
echo "ğŸ“„ ë¡¤ì•„ì›ƒ ì™„ë£Œ ë¦¬í¬íŠ¸"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# ë¡¤ì•„ì›ƒ ì •ë³´ ì—…ë°ì´íŠ¸
jq ".status = \"completed\" | .end_time = \"$(date -Iseconds)\"" "$rollout_plan" > "${rollout_plan}.tmp" && mv "${rollout_plan}.tmp" "$rollout_plan"

echo "ë¡¤ì•„ì›ƒ ID: $(jq -r '.rollout_id' "$rollout_plan")"
echo "ì „ëµ: $(jq -r '.strategy' "$rollout_plan")"
echo "ì‹œì‘ ì‹œê°„: $(jq -r '.start_time' "$rollout_plan")"
echo "ì™„ë£Œ ì‹œê°„: $(jq -r '.end_time' "$rollout_plan")"

# ë³€ê²½ ìš”ì•½
if [ -f "$rollout_dir/schema_before.json" ] && [ -f "$rollout_dir/schema_after.json" ]; then
    before_count=$(jq '.TotalFeatures' "$rollout_dir/schema_before.json")
    after_count=$(jq '.TotalFeatures' "$rollout_dir/schema_after.json")
    added_count=$((after_count - before_count))
    
    echo "ë³€ê²½ ìš”ì•½:"
    echo "  ë°°í¬ ì „ features: $before_countê°œ"
    echo "  ë°°í¬ í›„ features: $after_countê°œ"  
    echo "  ì¶”ê°€ëœ features: $added_countê°œ"
fi

echo "ë¡¤ì•„ì›ƒ ì•„í‹°íŒ©íŠ¸: $rollout_dir"

# ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
rollback_script="$rollout_dir/rollback.sh"
cat > "$rollback_script" << 'ROLLBACK_EOF'
#!/bin/bash
# ìë™ ìƒì„±ëœ ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸
echo "âš ï¸  ê²½ê³ : SageMaker Feature StoreëŠ” feature ì œê±°ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
echo "ë¡¤ë°±ì€ ìƒˆë¡œìš´ Feature Group ìƒì„±ìœ¼ë¡œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤."
echo ""
echo "ë¡¤ë°± ì˜µì…˜:"
echo "1. ìƒˆ Feature Groupì„ ì´ì „ ìŠ¤í‚¤ë§ˆë¡œ ìƒì„±"
echo "2. ë°ì´í„°ë¥¼ ìƒˆ Feature Groupìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜"
echo "3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • ì—…ë°ì´íŠ¸"
echo ""
echo "ì´ì „ ìŠ¤í‚¤ë§ˆ: $rollout_dir/schema_before.json"
ROLLBACK_EOF

chmod +x "$rollback_script"

echo ""
echo "ğŸ”™ ë¡¤ë°± ì •ë³´:"
echo "  âš ï¸  Feature ì œê±°ëŠ” ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
echo "  ğŸ“„ ë¡¤ë°± ì•ˆë‚´: $rollback_script"
echo "  ğŸ’¾ ì´ì „ ìŠ¤í‚¤ë§ˆ: $rollout_dir/schema_before.json"

echo ""
echo "ğŸ‰ ì ì§„ì  Feature ë¡¤ì•„ì›ƒ ì™„ë£Œ!"
```

## ì„±ëŠ¥ ìµœì í™”

### ëŒ€ìš©ëŸ‰ Feature ì¶”ê°€ ìµœì í™”

```bash
#!/bin/bash
# optimize_large_feature_additions.sh

optimize_feature_addition() {
    local feature_group=$1
    local features_file=$2
    
    echo "âš¡ ëŒ€ìš©ëŸ‰ Feature ì¶”ê°€ ìµœì í™”"
    
    # Feature ìˆ˜ í™•ì¸
    feature_count=$(jq 'length' "$features_file")
    
    if [ "$feature_count" -gt 10 ]; then
        echo "ğŸ“Š ë§ì€ ìˆ˜ì˜ features ê°ì§€ ($feature_countê°œ)"
        echo "ìµœì í™”ëœ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì ìš©í•©ë‹ˆë‹¤."
        
        # 5ê°œì”© ë°°ì¹˜ë¡œ ë‚˜ëˆ„ì–´ ì²˜ë¦¬
        batch_size=5
        batches=$(( (feature_count + batch_size - 1) / batch_size ))
        
        echo "ğŸ”„ $batchesê°œ ë°°ì¹˜ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤ (ë°°ì¹˜ë‹¹ $batch_sizeê°œ)"
        
        for ((i=0; i<batches; i++)); do
            start_index=$((i * batch_size))
            batch_file="/tmp/batch_${i}_features.json"
            
            jq ".[${start_index}:${start_index}+${batch_size}]" "$features_file" > "$batch_file"
            
            echo "ğŸ“¦ ë°°ì¹˜ $((i+1))/$batches ì²˜ë¦¬ ì¤‘..."
            
            if fs add-features "$feature_group" "$batch_file" --no-wait; then
                echo "âœ… ë°°ì¹˜ $((i+1)) ì„±ê³µ"
                
                # ë‹¤ìŒ ë°°ì¹˜ ì „ì— ì ì‹œ ëŒ€ê¸° (API ì œí•œ ê³ ë ¤)
                if [ $((i+1)) -lt $batches ]; then
                    echo "â³ API ì œí•œ ê³ ë ¤í•œ ëŒ€ê¸° (30ì´ˆ)..."
                    sleep 30
                fi
            else
                echo "âŒ ë°°ì¹˜ $((i+1)) ì‹¤íŒ¨"
                return 1
            fi
            
            rm -f "$batch_file"
        done
        
        echo "â³ ëª¨ë“  ë°°ì¹˜ ì™„ë£Œ ëŒ€ê¸° ì¤‘..."
        # ë§ˆì§€ë§‰ì— í•œ ë²ˆë§Œ ì™„ë£Œ ëŒ€ê¸°
        while true; do
            status=$(aws sagemaker describe-feature-group \
                    --feature-group-name "$feature_group" \
                    --query 'FeatureGroupStatus' --output text)
            
            if [ "$status" = "Created" ]; then
                echo "âœ… ëª¨ë“  Feature ì¶”ê°€ ì™„ë£Œ"
                break
            elif [ "$status" = "UpdateFailed" ]; then
                echo "âŒ Feature ì—…ë°ì´íŠ¸ ì‹¤íŒ¨"
                return 1
            else
                echo "í˜„ì¬ ìƒíƒœ: $status (ëŒ€ê¸° ì¤‘...)"
                sleep 15
            fi
        done
    else
        echo "ğŸ“Š ì ì€ ìˆ˜ì˜ featuresë¡œ ì¼ë°˜ ì²˜ë¦¬í•©ë‹ˆë‹¤"
        fs add-features "$feature_group" "$features_file"
    fi
}
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜ë“¤

```bash
# Feature ì¶”ê°€ ì‹¤íŒ¨
âŒ AWS ì˜¤ë¥˜ (ValidationException): Feature name already exists
# í•´ê²°: ê¸°ì¡´ feature ì´ë¦„ê³¼ ì¤‘ë³µ í™•ì¸

# ì˜ëª»ëœ FeatureType
âŒ ê²€ì¦ ì˜¤ë¥˜: Invalid FeatureType 'Integer'. Valid values: ['String', 'Integral', 'Fractional']
# í•´ê²°: FeatureTypeì„ 'Integral'ë¡œ ìˆ˜ì •

# ë²¡í„° ì°¨ì› ëˆ„ë½
âŒ Feature 'embeddings': List íƒ€ì…ì€ ìœ íš¨í•œ Dimensionì´ í•„ìš”í•©ë‹ˆë‹¤
# í•´ê²°: CollectionConfig.VectorConfig.Dimension ì„¤ì •

# Feature Group ì—†ìŒ
âŒ Feature Group 'non-existent'ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
# í•´ê²°: Feature Group ì´ë¦„ í™•ì¸ ë˜ëŠ” ìƒì„±
```

### ë³µêµ¬ ë° ì¬ì‹œë„

```bash
#!/bin/bash
# feature_addition_recovery.sh

recovery_add_features() {
    local feature_group=$1
    local features_file=$2
    local max_retries=${3:-3}
    
    echo "ğŸ”„ Feature ì¶”ê°€ ë³µêµ¬ ì‹œìŠ¤í…œ"
    
    for attempt in $(seq 1 $max_retries); do
        echo "ì‹œë„ $attempt/$max_retries..."
        
        if fs add-features "$feature_group" "$features_file"; then
            echo "âœ… $attemptë²ˆì§¸ ì‹œë„ ì„±ê³µ"
            return 0
        else
            echo "âŒ $attemptë²ˆì§¸ ì‹œë„ ì‹¤íŒ¨"
            
            if [ $attempt -lt $max_retries ]; then
                wait_time=$((attempt * 30))
                echo "â³ ${wait_time}ì´ˆ ëŒ€ê¸° í›„ ì¬ì‹œë„..."
                sleep $wait_time
            fi
        fi
    done
    
    echo "ğŸ’¥ ëª¨ë“  ì¬ì‹œë„ ì‹¤íŒ¨"
    return 1
}
```

## ê´€ë ¨ ëª…ë ¹ì–´

- [`schema`](13.schema.md) - Feature Group ìŠ¤í‚¤ë§ˆ ì¡°íšŒ
- [`schema-template`](14.schema-template.md) - Feature definition í…œí”Œë¦¿ ìƒì„±  
- [`list`](01.list.md) - Feature Group ëª©ë¡ í™•ì¸
- [`create`](02.create.md) - ìƒˆ Feature Group ìƒì„±

## ì°¸ê³ ì‚¬í•­

- **ë¶ˆê°€ì—­ì  ë³€ê²½**: ì¶”ê°€ëœ featureëŠ” ì œê±°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤
- **ìŠ¤í‚¤ë§ˆ ì§„í™”**: ê¸°ì¡´ ë°ì´í„°ì™€ì˜ í˜¸í™˜ì„±ì„ í•­ìƒ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤  
- **ì„±ëŠ¥ ì˜í–¥**: ë§ì€ ìˆ˜ì˜ feature ì¶”ê°€ëŠ” ì¿¼ë¦¬ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- **ë¹„ìš© ê³ ë ¤**: ë²¡í„° featureëŠ” ìŠ¤í† ë¦¬ì§€ ë¹„ìš©ì´ ë§ì´ ë“­ë‹ˆë‹¤