# 14. schema-template ëª…ë ¹ì–´

ìƒˆë¡œìš´ feature definitionì„ ìœ„í•œ í…œí”Œë¦¿ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

## ê¸°ë³¸ ì‚¬ìš©ë²•

```bash
# ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„±
fs schema-template

# íŠ¹ì • íŒŒì¼ëª…ìœ¼ë¡œ í…œí”Œë¦¿ ìƒì„±
fs schema-template --output my_features.json
```

## ëª…ë ¹ì–´ ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `--output`, `-o` | ì¶œë ¥ íŒŒì¼ ê²½ë¡œ | feature_template.json |

## ìƒì„±ë˜ëŠ” í…œí”Œë¦¿ êµ¬ì¡°

ê¸°ë³¸ í…œí”Œë¦¿ì—ëŠ” ë‹¤ì–‘í•œ Feature Typeê³¼ Collection Typeì˜ ì˜ˆì‹œê°€ í¬í•¨ë©ë‹ˆë‹¤:

```json
[
  {
    "FeatureName": "example_string_feature",
    "FeatureType": "String",
    "Description": "ì˜ˆì‹œ ë¬¸ìì—´ feature"
  },
  {
    "FeatureName": "example_integral_feature",
    "FeatureType": "Integral", 
    "Description": "ì˜ˆì‹œ ì •ìˆ˜í˜• feature"
  },
  {
    "FeatureName": "example_fractional_feature",
    "FeatureType": "Fractional",
    "Description": "ì˜ˆì‹œ ì‹¤ìˆ˜í˜• feature"
  },
  {
    "FeatureName": "example_list_feature",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 128
      }
    },
    "Description": "ì˜ˆì‹œ ë²¡í„° ë¦¬ìŠ¤íŠ¸ feature"
  }
]
```

## Feature Type ì°¸ê³ 

### ê¸°ë³¸ ë°ì´í„° íƒ€ì…

| Type | ì„¤ëª… | ì˜ˆì‹œ ê°’ |
|------|------|---------|
| `String` | ë¬¸ìì—´ ë°ì´í„° | "premium", "active", "2024-01-01" |
| `Integral` | ì •ìˆ˜í˜• ë°ì´í„° | 25, 100, -5 |
| `Fractional` | ì‹¤ìˆ˜í˜• ë°ì´í„° | 3.14, 99.99, -0.5 |

### Collection Type

| Type | ì„¤ëª… | í•„ìˆ˜ ì„¤ì • | ì˜ˆì‹œ |
|------|------|----------|------|
| `List` | ë²¡í„°/ë°°ì—´ í˜•íƒœ | VectorConfig.Dimension | [0.1, 0.2, 0.3] |
| `Set` | ì§‘í•© í˜•íƒœ | - | {"red", "blue", "green"} |

## ìƒì„¸ ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„± ë° ì‚¬ìš©

```bash
# 1. ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„±
fs schema-template

# ì¶œë ¥:
# âœ… Feature definition í…œí”Œë¦¿ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤: feature_template.json
# 
# ğŸ“ í…œí”Œë¦¿ ì‚¬ìš©ë²•:
#   1. í…œí”Œë¦¿ íŒŒì¼ì„ í¸ì§‘í•˜ì—¬ ì›í•˜ëŠ” featureë“¤ì„ ì •ì˜í•˜ì„¸ìš”
#   2. 'fs add-features <feature-group-name> <template-file>' ëª…ë ¹ìœ¼ë¡œ ì¶”ê°€í•˜ì„¸ìš”
# 
# ğŸ“– FeatureType ì˜µì…˜:
#   - String: ë¬¸ìì—´ ë°ì´í„°
#   - Integral: ì •ìˆ˜í˜• ë°ì´í„°
#   - Fractional: ì‹¤ìˆ˜í˜• ë°ì´í„°
# 
# ğŸ“– CollectionType ì˜µì…˜:
#   - List: ë²¡í„°ë‚˜ ë°°ì—´ í˜•íƒœì˜ ë°ì´í„°
#   - Set: ì§‘í•© í˜•íƒœì˜ ë°ì´í„°

# 2. ìƒì„±ëœ í…œí”Œë¦¿ í™•ì¸
cat feature_template.json

# 3. í…œí”Œë¦¿ í¸ì§‘
vim feature_template.json

# 4. Feature ì¶”ê°€ì— ì‚¬ìš©
fs add-features my-feature-group feature_template.json --dry-run
fs add-features my-feature-group feature_template.json
```

### íŠ¹ì • ìš©ë„ë³„ í…œí”Œë¦¿ ìƒì„±

```bash
# ê³ ê° ë°ì´í„°ìš© í…œí”Œë¦¿
fs schema-template --output customer_features.json

# ML ëª¨ë¸ìš© í…œí”Œë¦¿
fs schema-template --output ml_features.json

# ë¶„ì„ìš© í…œí”Œë¦¿
fs schema-template --output analytics_features.json
```

## ê³ ê¸‰ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### 1. ë„ë©”ì¸ë³„ ìŠ¤ë§ˆíŠ¸ í…œí”Œë¦¿ ìƒì„±ê¸°

```bash
#!/bin/bash
# smart_template_generator.sh - ë„ë©”ì¸ë³„ ìŠ¤ë§ˆíŠ¸ í…œí”Œë¦¿ ìƒì„±

generate_domain_template() {
    local domain="$1"
    local output_file="${2:-${domain}_features.json}"
    
    case "$domain" in
        "ecommerce")
            generate_ecommerce_template "$output_file"
            ;;
        "finance")
            generate_finance_template "$output_file"
            ;;
        "ml")
            generate_ml_template "$output_file"
            ;;
        "iot")
            generate_iot_template "$output_file"
            ;;
        "social")
            generate_social_template "$output_file"
            ;;
        *)
            echo "âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë„ë©”ì¸: $domain"
            echo "ì§€ì› ë„ë©”ì¸: ecommerce, finance, ml, iot, social"
            return 1
            ;;
    esac
}

generate_ecommerce_template() {
    local output_file="$1"
    
    echo "ğŸ›’ E-commerce Feature í…œí”Œë¦¿ ìƒì„±: $output_file"
    
    cat > "$output_file" << 'EOF'
[
  {
    "FeatureName": "customer_id",
    "FeatureType": "String",
    "Description": "ê³ ìœ í•œ ê³ ê° ì‹ë³„ì"
  },
  {
    "FeatureName": "customer_segment",
    "FeatureType": "String", 
    "Description": "ê³ ê° ì„¸ê·¸ë¨¼íŠ¸ (VIP, Premium, Standard, Basic)"
  },
  {
    "FeatureName": "lifetime_value",
    "FeatureType": "Fractional",
    "Description": "ê³ ê° ìƒì•  ê°€ì¹˜ (CLV)"
  },
  {
    "FeatureName": "purchase_count_30d",
    "FeatureType": "Integral",
    "Description": "ìµœê·¼ 30ì¼ê°„ êµ¬ë§¤ íšŸìˆ˜"
  },
  {
    "FeatureName": "total_spent_amount",
    "FeatureType": "Fractional",
    "Description": "ì´ êµ¬ë§¤ ê¸ˆì•¡"
  },
  {
    "FeatureName": "preferred_categories",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ì„ í˜¸í•˜ëŠ” ìƒí’ˆ ì¹´í…Œê³ ë¦¬ ì§‘í•©"
  },
  {
    "FeatureName": "browsing_history_embeddings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 256
      }
    },
    "Description": "ë¸Œë¼ìš°ì§• ì´ë ¥ ê¸°ë°˜ ì„ë² ë”© ë²¡í„°"
  },
  {
    "FeatureName": "churn_probability",
    "FeatureType": "Fractional",
    "Description": "ì´íƒˆ í™•ë¥  ì ìˆ˜ (0.0-1.0)"
  },
  {
    "FeatureName": "last_purchase_date",
    "FeatureType": "String",
    "Description": "ë§ˆì§€ë§‰ êµ¬ë§¤ì¼ (YYYY-MM-DD í˜•ì‹)"
  },
  {
    "FeatureName": "avg_order_value",
    "FeatureType": "Fractional",
    "Description": "í‰ê·  ì£¼ë¬¸ ê¸ˆì•¡"
  },
  {
    "FeatureName": "product_ratings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 50
      }
    },
    "Description": "ìƒí’ˆë³„ í‰ì  ì´ë ¥ ë²¡í„°"
  },
  {
    "FeatureName": "event_time",
    "FeatureType": "Fractional",
    "Description": "ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"
  }
]
EOF
    
    echo "âœ… E-commerce í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
    echo "ğŸ’¡ ì£¼ìš” íŠ¹ì§•:"
    echo "  - ê³ ê° ì„¸ë¶„í™” features"
    echo "  - êµ¬ë§¤ í–‰ë™ ë¶„ì„ features" 
    echo "  - ê°œì¸í™” ì¶”ì²œì„ ìœ„í•œ ì„ë² ë”©"
    echo "  - ì´íƒˆ ì˜ˆì¸¡ features"
}

generate_finance_template() {
    local output_file="$1"
    
    echo "ğŸ’° Finance Feature í…œí”Œë¦¿ ìƒì„±: $output_file"
    
    cat > "$output_file" << 'EOF'
[
  {
    "FeatureName": "account_id",
    "FeatureType": "String",
    "Description": "ê³„ì¢Œ ê³ ìœ  ì‹ë³„ì"
  },
  {
    "FeatureName": "account_balance",
    "FeatureType": "Fractional",
    "Description": "í˜„ì¬ ê³„ì¢Œ ì”ì•¡"
  },
  {
    "FeatureName": "credit_score",
    "FeatureType": "Integral",
    "Description": "ì‹ ìš© ì ìˆ˜ (300-850)"
  },
  {
    "FeatureName": "monthly_income",
    "FeatureType": "Fractional",
    "Description": "ì›” ì†Œë“"
  },
  {
    "FeatureName": "debt_to_income_ratio",
    "FeatureType": "Fractional",
    "Description": "ì†Œë“ ëŒ€ë¹„ ë¶€ì±„ ë¹„ìœ¨"
  },
  {
    "FeatureName": "transaction_count_30d",
    "FeatureType": "Integral",
    "Description": "ìµœê·¼ 30ì¼ê°„ ê±°ë˜ íšŸìˆ˜"
  },
  {
    "FeatureName": "avg_transaction_amount",
    "FeatureType": "Fractional",
    "Description": "í‰ê·  ê±°ë˜ ê¸ˆì•¡"
  },
  {
    "FeatureName": "transaction_categories",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ê±°ë˜ ì¹´í…Œê³ ë¦¬ ì§‘í•©"
  },
  {
    "FeatureName": "risk_indicators",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 20
      }
    },
    "Description": "ë¦¬ìŠ¤í¬ ì§€í‘œ ë²¡í„°"
  },
  {
    "FeatureName": "fraud_score",
    "FeatureType": "Fractional",
    "Description": "ì‚¬ê¸° ìœ„í—˜ ì ìˆ˜ (0.0-1.0)"
  },
  {
    "FeatureName": "account_age_days",
    "FeatureType": "Integral",
    "Description": "ê³„ì¢Œ ê°œì„¤ í›„ ê²½ê³¼ ì¼ìˆ˜"
  },
  {
    "FeatureName": "default_probability",
    "FeatureType": "Fractional",
    "Description": "ì±„ë¬´ë¶ˆì´í–‰ í™•ë¥ "
  },
  {
    "FeatureName": "event_time",
    "FeatureType": "Fractional",
    "Description": "ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"
  }
]
EOF
    
    echo "âœ… Finance í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
    echo "ğŸ’¡ ì£¼ìš” íŠ¹ì§•:"
    echo "  - ì‹ ìš© í‰ê°€ features"
    echo "  - ë¦¬ìŠ¤í¬ ê´€ë¦¬ features"
    echo "  - ì‚¬ê¸° íƒì§€ features"
    echo "  - ê·œì œ ì¤€ìˆ˜ features"
}

generate_ml_template() {
    local output_file="$1"
    
    echo "ğŸ¤– ML Feature í…œí”Œë¦¿ ìƒì„±: $output_file"
    
    cat > "$output_file" << 'EOF'
[
  {
    "FeatureName": "entity_id",
    "FeatureType": "String",
    "Description": "ì—”í„°í‹° ê³ ìœ  ì‹ë³„ì"
  },
  {
    "FeatureName": "numerical_feature_1",
    "FeatureType": "Fractional",
    "Description": "ì •ê·œí™”ëœ ìˆ˜ì¹˜í˜• feature"
  },
  {
    "FeatureName": "numerical_feature_2",
    "FeatureType": "Fractional",
    "Description": "í‘œì¤€í™”ëœ ìˆ˜ì¹˜í˜• feature"
  },
  {
    "FeatureName": "categorical_encoded",
    "FeatureType": "Integral",
    "Description": "ì›í•« ì¸ì½”ë”©ëœ ì¹´í…Œê³ ë¦¬ feature"
  },
  {
    "FeatureName": "text_embeddings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 768
      }
    },
    "Description": "BERT ê¸°ë°˜ í…ìŠ¤íŠ¸ ì„ë² ë”©"
  },
  {
    "FeatureName": "image_features",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 2048
      }
    },
    "Description": "CNN ì¶”ì¶œ ì´ë¯¸ì§€ íŠ¹ì„±"
  },
  {
    "FeatureName": "sequence_features",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 100
      }
    },
    "Description": "ì‹œí€€ìŠ¤ ë°ì´í„° íŠ¹ì„±"
  },
  {
    "FeatureName": "interaction_features",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 50
      }
    },
    "Description": "êµì°¨ íŠ¹ì„± ë²¡í„°"
  },
  {
    "FeatureName": "target_variable",
    "FeatureType": "Fractional",
    "Description": "ì˜ˆì¸¡ ëŒ€ìƒ ë³€ìˆ˜"
  },
  {
    "FeatureName": "prediction_confidence",
    "FeatureType": "Fractional",
    "Description": "ì˜ˆì¸¡ ì‹ ë¢°ë„ ì ìˆ˜"
  },
  {
    "FeatureName": "model_version",
    "FeatureType": "String",
    "Description": "ì‚¬ìš©ëœ ëª¨ë¸ ë²„ì „"
  },
  {
    "FeatureName": "feature_importance",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 10
      }
    },
    "Description": "Feature ì¤‘ìš”ë„ ê°€ì¤‘ì¹˜"
  },
  {
    "FeatureName": "event_time",
    "FeatureType": "Fractional",
    "Description": "ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"
  }
]
EOF
    
    echo "âœ… ML í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
    echo "ğŸ’¡ ì£¼ìš” íŠ¹ì§•:"
    echo "  - ê³ ì°¨ì› ì„ë² ë”© ë²¡í„°"
    echo "  - ëª¨ë¸ ì˜ˆì¸¡ ê´€ë ¨ features"
    echo "  - Feature ì¤‘ìš”ë„ ì¶”ì "
    echo "  - ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì… ì§€ì›"
}

generate_iot_template() {
    local output_file="$1"
    
    echo "ğŸ“¡ IoT Feature í…œí”Œë¦¿ ìƒì„±: $output_file"
    
    cat > "$output_file" << 'EOF'
[
  {
    "FeatureName": "device_id",
    "FeatureType": "String",
    "Description": "IoT ë””ë°”ì´ìŠ¤ ê³ ìœ  ì‹ë³„ì"
  },
  {
    "FeatureName": "sensor_temperature",
    "FeatureType": "Fractional",
    "Description": "ì˜¨ë„ ì„¼ì„œ ê°’ (ì„­ì”¨)"
  },
  {
    "FeatureName": "sensor_humidity",
    "FeatureType": "Fractional",
    "Description": "ìŠµë„ ì„¼ì„œ ê°’ (%)"
  },
  {
    "FeatureName": "sensor_pressure",
    "FeatureType": "Fractional",
    "Description": "ê¸°ì•• ì„¼ì„œ ê°’ (hPa)"
  },
  {
    "FeatureName": "battery_level",
    "FeatureType": "Fractional",
    "Description": "ë°°í„°ë¦¬ ì”ëŸ‰ (%)"
  },
  {
    "FeatureName": "signal_strength",
    "FeatureType": "Integral",
    "Description": "ì‹ í˜¸ ê°•ë„ (dBm)"
  },
  {
    "FeatureName": "location_coordinates",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 2
      }
    },
    "Description": "GPS ì¢Œí‘œ [ìœ„ë„, ê²½ë„]"
  },
  {
    "FeatureName": "accelerometer_data",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 3
      }
    },
    "Description": "ê°€ì†ë„ê³„ ë°ì´í„° [x, y, z]"
  },
  {
    "FeatureName": "device_status",
    "FeatureType": "String",
    "Description": "ë””ë°”ì´ìŠ¤ ìƒíƒœ (online, offline, maintenance)"
  },
  {
    "FeatureName": "error_codes",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ì—ëŸ¬ ì½”ë“œ ì§‘í•©"
  },
  {
    "FeatureName": "uptime_hours",
    "FeatureType": "Fractional",
    "Description": "ì—°ì† ê°€ë™ ì‹œê°„ (ì‹œê°„)"
  },
  {
    "FeatureName": "data_transmission_rate",
    "FeatureType": "Fractional",
    "Description": "ë°ì´í„° ì „ì†¡ë¥  (MB/s)"
  },
  {
    "FeatureName": "anomaly_score",
    "FeatureType": "Fractional",
    "Description": "ì´ìƒ íƒì§€ ì ìˆ˜"
  },
  {
    "FeatureName": "event_time",
    "FeatureType": "Fractional",
    "Description": "ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"
  }
]
EOF
    
    echo "âœ… IoT í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
    echo "ğŸ’¡ ì£¼ìš” íŠ¹ì§•:"
    echo "  - ì„¼ì„œ ë°ì´í„° features"
    echo "  - ë””ë°”ì´ìŠ¤ ìƒíƒœ ì¶”ì "
    echo "  - ìœ„ì¹˜ ë° ì›€ì§ì„ ë°ì´í„°"
    echo "  - ì´ìƒ íƒì§€ features"
}

generate_social_template() {
    local output_file="$1"
    
    echo "ğŸ‘¥ Social Media Feature í…œí”Œë¦¿ ìƒì„±: $output_file"
    
    cat > "$output_file" << 'EOF'
[
  {
    "FeatureName": "user_id",
    "FeatureType": "String",
    "Description": "ì‚¬ìš©ì ê³ ìœ  ì‹ë³„ì"
  },
  {
    "FeatureName": "follower_count",
    "FeatureType": "Integral",
    "Description": "íŒ”ë¡œì›Œ ìˆ˜"
  },
  {
    "FeatureName": "following_count", 
    "FeatureType": "Integral",
    "Description": "íŒ”ë¡œì‰ ìˆ˜"
  },
  {
    "FeatureName": "post_count",
    "FeatureType": "Integral",
    "Description": "ì´ ê²Œì‹œë¬¼ ìˆ˜"
  },
  {
    "FeatureName": "engagement_rate",
    "FeatureType": "Fractional",
    "Description": "ì°¸ì—¬ìœ¨ (ì¢‹ì•„ìš”+ëŒ“ê¸€+ê³µìœ )/íŒ”ë¡œì›Œ"
  },
  {
    "FeatureName": "avg_likes_per_post",
    "FeatureType": "Fractional",
    "Description": "ê²Œì‹œë¬¼ë‹¹ í‰ê·  ì¢‹ì•„ìš” ìˆ˜"
  },
  {
    "FeatureName": "content_categories",
    "FeatureType": "String",
    "CollectionType": "Set",
    "Description": "ì£¼ìš” ì½˜í…ì¸  ì¹´í…Œê³ ë¦¬"
  },
  {
    "FeatureName": "post_embeddings",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 512
      }
    },
    "Description": "ê²Œì‹œë¬¼ ë‚´ìš© ì„ë² ë”©"
  },
  {
    "FeatureName": "sentiment_scores",
    "FeatureType": "String",
    "CollectionType": "List",
    "CollectionConfig": {
      "VectorConfig": {
        "Dimension": 3
      }
    },
    "Description": "ê°ì • ë¶„ì„ ì ìˆ˜ [ê¸ì •, ì¤‘ë¦½, ë¶€ì •]"
  },
  {
    "FeatureName": "influence_score",
    "FeatureType": "Fractional",
    "Description": "ì˜í–¥ë ¥ ì ìˆ˜"
  },
  {
    "FeatureName": "activity_level",
    "FeatureType": "String",
    "Description": "í™œë™ ìˆ˜ì¤€ (high, medium, low)"
  },
  {
    "FeatureName": "account_verified",
    "FeatureType": "String",
    "Description": "ê³„ì • ì¸ì¦ ì—¬ë¶€ (verified, unverified)"
  },
  {
    "FeatureName": "account_age_days",
    "FeatureType": "Integral",
    "Description": "ê³„ì • ìƒì„± í›„ ê²½ê³¼ ì¼ìˆ˜"
  },
  {
    "FeatureName": "event_time",
    "FeatureType": "Fractional",
    "Description": "ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"
  }
]
EOF
    
    echo "âœ… Social Media í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ"
    echo "ğŸ’¡ ì£¼ìš” íŠ¹ì§•:"
    echo "  - ì‚¬ìš©ì ì°¸ì—¬ë„ metrics"
    echo "  - ì½˜í…ì¸  ë¶„ì„ features"
    echo "  - ì˜í–¥ë ¥ ì¸¡ì • features"
    echo "  - ê°ì • ë¶„ì„ ê¸°ëŠ¥"
}

# ì‚¬ìš© ì˜ˆì‹œ
echo "ğŸ¯ ë„ë©”ì¸ë³„ ìŠ¤ë§ˆíŠ¸ í…œí”Œë¦¿ ìƒì„±ê¸°"
echo ""
echo "ì‚¬ìš©ë²•: generate_domain_template <domain> [output_file]"
echo ""
echo "ì§€ì› ë„ë©”ì¸:"
echo "  - ecommerce: ì „ììƒê±°ë˜ features"
echo "  - finance: ê¸ˆìœµ ì„œë¹„ìŠ¤ features" 
echo "  - ml: ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ features"
echo "  - iot: IoT ë””ë°”ì´ìŠ¤ features"
echo "  - social: ì†Œì…œë¯¸ë””ì–´ features"
echo ""
echo "ì˜ˆì‹œ:"
echo "  generate_domain_template ecommerce"
echo "  generate_domain_template finance finance_template.json"
echo "  generate_domain_template ml ml_features.json"

# í•¨ìˆ˜ ì‹¤í–‰ (ì‚¬ìš©ìê°€ í˜¸ì¶œ)
if [ $# -gt 0 ]; then
    generate_domain_template "$@"
fi
```

### 2. ëŒ€í™”í˜• í…œí”Œë¦¿ ë¹Œë”

```bash
#!/bin/bash
# interactive_template_builder.sh - ëŒ€í™”í˜• í…œí”Œë¦¿ ìƒì„±ê¸°

build_interactive_template() {
    local output_file="${1:-custom_features.json}"
    
    echo "ğŸ¯ ëŒ€í™”í˜• Feature í…œí”Œë¦¿ ë¹Œë”"
    echo "ì¶œë ¥ íŒŒì¼: $output_file"
    echo ""
    
    # ê¸°ë³¸ ì •ë³´ ìˆ˜ì§‘
    echo "ğŸ“‹ ê¸°ë³¸ ì •ë³´ ì…ë ¥"
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
    
    read -p "Feature Group ì´ë¦„ (ì˜ˆ: customer-data): " feature_group_name
    read -p "í”„ë¡œì íŠ¸ ì„¤ëª… (ì˜ˆ: ê³ ê° ë¶„ì„ìš© features): " project_description
    
    echo ""
    echo "ğŸ”§ Feature ì •ì˜"
    echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
    
    features=()
    feature_count=0
    
    while true; do
        echo ""
        echo "Feature #$((feature_count + 1)) ì •ì˜:"
        
        # Feature ì´ë¦„
        read -p "  Feature ì´ë¦„ (ë¹ˆ ê°’ ì…ë ¥ì‹œ ì¢…ë£Œ): " feature_name
        if [ -z "$feature_name" ]; then
            break
        fi
        
        # Feature íƒ€ì… ì„ íƒ
        echo "  Feature íƒ€ì… ì„ íƒ:"
        echo "    1) String (ë¬¸ìì—´)"
        echo "    2) Integral (ì •ìˆ˜)"
        echo "    3) Fractional (ì‹¤ìˆ˜)"
        
        while true; do
            read -p "  ì„ íƒ (1-3): " type_choice
            case "$type_choice" in
                1) feature_type="String"; break ;;
                2) feature_type="Integral"; break ;;
                3) feature_type="Fractional"; break ;;
                *) echo "    âš ï¸  1, 2, 3 ì¤‘ì—ì„œ ì„ íƒí•´ì£¼ì„¸ìš”" ;;
            esac
        done
        
        # Collection íƒ€ì… ì„ íƒ
        echo "  Collection íƒ€ì…ì´ í•„ìš”í•œê°€ìš”?"
        echo "    1) ì•„ë‹ˆì˜¤ (ë‹¨ì¼ ê°’)"
        echo "    2) List (ë²¡í„°/ë°°ì—´)"
        echo "    3) Set (ì§‘í•©)"
        
        collection_type=""
        collection_config=""
        
        while true; do
            read -p "  ì„ íƒ (1-3): " collection_choice
            case "$collection_choice" in
                1) break ;;
                2) 
                    collection_type="List"
                    read -p "    ë²¡í„° ì°¨ì› (ì˜ˆ: 128): " dimension
                    if [ -n "$dimension" ] && [ "$dimension" -gt 0 ] 2>/dev/null; then
                        collection_config="{\"VectorConfig\":{\"Dimension\":$dimension}}"
                    else
                        echo "    âš ï¸  ì˜ëª»ëœ ì°¨ì›ê°’, ê¸°ë³¸ê°’ 128 ì‚¬ìš©"
                        collection_config="{\"VectorConfig\":{\"Dimension\":128}}"
                    fi
                    break 
                    ;;
                3) collection_type="Set"; break ;;
                *) echo "    âš ï¸  1, 2, 3 ì¤‘ì—ì„œ ì„ íƒí•´ì£¼ì„¸ìš”" ;;
            esac
        done
        
        # ì„¤ëª…
        read -p "  Feature ì„¤ëª… (ì„ íƒì‚¬í•­): " feature_description
        
        # Feature ê°ì²´ êµ¬ì„±
        feature_json="{"
        feature_json+="\"FeatureName\":\"$feature_name\""
        feature_json+=",\"FeatureType\":\"$feature_type\""
        
        if [ -n "$collection_type" ]; then
            feature_json+=",\"CollectionType\":\"$collection_type\""
        fi
        
        if [ -n "$collection_config" ]; then
            feature_json+=",\"CollectionConfig\":$collection_config"
        fi
        
        if [ -n "$feature_description" ]; then
            feature_json+=",\"Description\":\"$feature_description\""
        fi
        
        feature_json+="}"
        
        features+=("$feature_json")
        feature_count=$((feature_count + 1))
        
        echo "  âœ… Feature ì¶”ê°€ë¨: $feature_name ($feature_type)"
        
        # ê³„ì† ì—¬ë¶€ í™•ì¸
        if [ $feature_count -ge 10 ]; then
            echo ""
            echo "âš ï¸  10ê°œ ì´ìƒì˜ featureë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
            read -r continue_adding
            if [[ ! $continue_adding =~ ^[Yy]$ ]]; then
                break
            fi
        fi
    done
    
    if [ ${#features[@]} -eq 0 ]; then
        echo ""
        echo "âŒ Featureê°€ ì¶”ê°€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í…œí”Œë¦¿ ìƒì„±ì„ ì·¨ì†Œí•©ë‹ˆë‹¤."
        return 1
    fi
    
    # event_time feature ìë™ ì¶”ê°€ í™•ì¸
    echo ""
    echo "ğŸ“… event_time featureë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/n)"
    read -r add_event_time
    
    if [[ ! $add_event_time =~ ^[Nn]$ ]]; then
        event_time_feature='{"FeatureName":"event_time","FeatureType":"Fractional","Description":"ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„ (Unix timestamp)"}'
        features+=("$event_time_feature")
        feature_count=$((feature_count + 1))
        echo "  âœ… event_time feature ì¶”ê°€ë¨"
    fi
    
    # JSON íŒŒì¼ ìƒì„±
    echo ""
    echo "ğŸ’¾ í…œí”Œë¦¿ íŒŒì¼ ìƒì„± ì¤‘..."
    
    # JSON ë°°ì—´ êµ¬ì„±
    json_content="["
    for i in "${!features[@]}"; do
        if [ $i -gt 0 ]; then
            json_content+=","
        fi
        json_content+="${features[$i]}"
    done
    json_content+="]"
    
    # ì˜ˆì˜ê²Œ í¬ë§·íŒ…í•˜ì—¬ íŒŒì¼ ì €ì¥
    echo "$json_content" | python3 -m json.tool > "$output_file"
    
    # í—¤ë” ì£¼ì„ ì¶”ê°€
    temp_file="/tmp/template_with_header.json"
    
    cat > "$temp_file" << EOF
/*
 * Feature Definition Template
 * Generated: $(date)
 * Feature Group: $feature_group_name
 * Description: $project_description
 * Total Features: $feature_count
 */
EOF
    
    cat "$output_file" >> "$temp_file"
    mv "$temp_file" "$output_file"
    
    # ê²°ê³¼ ìš”ì•½
    echo ""
    echo "âœ… ëŒ€í™”í˜• í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ!"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "ğŸ“„ íŒŒì¼: $output_file"
    echo "ğŸ“Š Feature ìˆ˜: $feature_countê°œ"
    echo "ğŸ¯ Feature Group: $feature_group_name"
    echo ""
    
    # Feature ìš”ì•½ í‘œì‹œ
    echo "ğŸ“‹ ìƒì„±ëœ Features:"
    python3 << EOF
import json

try:
    with open('$output_file', 'r') as f:
        content = f.read()
        # ì£¼ì„ ì œê±°
        json_start = content.find('[')
        if json_start != -1:
            json_content = content[json_start:]
            features = json.loads(json_content)
            
            for i, feature in enumerate(features, 1):
                name = feature['FeatureName']
                ftype = feature['FeatureType']
                collection = feature.get('CollectionType', '')
                collection_info = f" [{collection}]" if collection else ""
                
                print(f"  {i:2d}. {name} ({ftype}{collection_info})")

except Exception as e:
    print(f"  âš ï¸ ìš”ì•½ í‘œì‹œ ì¤‘ ì˜¤ë¥˜: {e}")
EOF
    
    echo ""
    echo "ğŸš€ ë‹¤ìŒ ë‹¨ê³„:"
    echo "  1. íŒŒì¼ ë‚´ìš© ê²€í† : cat $output_file"
    echo "  2. í•„ìš”ì‹œ ì¶”ê°€ í¸ì§‘: vim $output_file"
    echo "  3. Feature ì¶”ê°€: fs add-features $feature_group_name $output_file --dry-run"
    echo "  4. ì‹¤ì œ ì ìš©: fs add-features $feature_group_name $output_file"
    
    # ì¶”ê°€ ì˜µì…˜ë“¤
    echo ""
    echo "ğŸ”§ ì¶”ê°€ ì˜µì…˜:"
    echo "  v) ìƒì„±ëœ íŒŒì¼ ë³´ê¸°"
    echo "  e) íŒŒì¼ í¸ì§‘"
    echo "  t) í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (dry-run)"
    echo "  q) ì¢…ë£Œ"
    
    while true; do
        read -p "ì„ íƒ (v/e/t/q): " action_choice
        case "$action_choice" in
            v|V)
                echo ""
                echo "ğŸ“„ ìƒì„±ëœ í…œí”Œë¦¿ ë‚´ìš©:"
                echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
                cat "$output_file"
                ;;
            e|E)
                echo "ğŸ“ íŒŒì¼ í¸ì§‘ê¸° ì‹¤í–‰..."
                ${EDITOR:-vim} "$output_file"
                echo "âœ… í¸ì§‘ ì™„ë£Œ"
                ;;
            t|T)
                if [ -n "$feature_group_name" ]; then
                    echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘..."
                    if fs add-features "$feature_group_name" "$output_file" --dry-run; then
                        echo "âœ… í…ŒìŠ¤íŠ¸ í†µê³¼!"
                    else
                        echo "âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨. íŒŒì¼ì„ ìˆ˜ì •í•´ì£¼ì„¸ìš”."
                    fi
                else
                    echo "âš ï¸  Feature Group ì´ë¦„ì´ í•„ìš”í•©ë‹ˆë‹¤"
                fi
                ;;
            q|Q)
                echo "ğŸ‘‹ í…œí”Œë¦¿ ë¹Œë” ì¢…ë£Œ"
                break
                ;;
            *)
                echo "âš ï¸  v, e, t, q ì¤‘ì—ì„œ ì„ íƒí•´ì£¼ì„¸ìš”"
                ;;
        esac
        echo ""
    done
}

# ì‚¬ìš© ì˜ˆì‹œ
echo "ğŸ¯ ëŒ€í™”í˜• Feature í…œí”Œë¦¿ ë¹Œë” ì‹œì‘"
echo ""
echo "ì‚¬ìš©ë²•: build_interactive_template [output_file]"
echo ""

if [ $# -gt 0 ]; then
    build_interactive_template "$@"
else
    read -p "ì¶œë ¥ íŒŒì¼ëª… (ê¸°ë³¸ê°’: custom_features.json): " user_output
    build_interactive_template "${user_output:-custom_features.json}"
fi
```

### 3. ê¸°ì¡´ ë°ì´í„°ì—ì„œ í…œí”Œë¦¿ ì¶”ë¡ 

```bash
#!/bin/bash
# data_driven_template_generator.sh - ë°ì´í„° ê¸°ë°˜ í…œí”Œë¦¿ ìƒì„±

infer_template_from_data() {
    local data_file="$1"
    local output_template="${2:-inferred_features.json}"
    local sample_size="${3:-1000}"
    
    if [ ! -f "$data_file" ]; then
        echo "âŒ ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: $data_file"
        return 1
    fi
    
    echo "ğŸ” ë°ì´í„° ê¸°ë°˜ í…œí”Œë¦¿ ì¶”ë¡ "
    echo "ì…ë ¥ íŒŒì¼: $data_file"
    echo "ì¶œë ¥ í…œí”Œë¦¿: $output_template"
    echo "ìƒ˜í”Œ í¬ê¸°: $sample_size"
    echo ""
    
    # íŒŒì¼ í™•ì¥ìì— ë”°ë¥¸ ì²˜ë¦¬
    file_extension="${data_file##*.}"
    
    case "$file_extension" in
        "csv")
            infer_from_csv "$data_file" "$output_template" "$sample_size"
            ;;
        "json")
            infer_from_json "$data_file" "$output_template" "$sample_size"
            ;;
        "parquet")
            infer_from_parquet "$data_file" "$output_template" "$sample_size"
            ;;
        *)
            echo "âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹: $file_extension"
            echo "ì§€ì› í˜•ì‹: csv, json, parquet"
            return 1
            ;;
    esac
}

infer_from_csv() {
    local csv_file="$1"
    local output_template="$2"
    local sample_size="$3"
    
    echo "ğŸ“Š CSV íŒŒì¼ ë¶„ì„ ì¤‘..."
    
    python3 << EOF
import pandas as pd
import json
import numpy as np
from collections import Counter
import re

# CSV íŒŒì¼ ì½ê¸°
try:
    df = pd.read_csv('$csv_file', nrows=$sample_size)
    print(f"âœ… ë°ì´í„° ë¡œë“œ ì™„ë£Œ: {len(df)} rows, {len(df.columns)} columns")
except Exception as e:
    print(f"âŒ CSV íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: {e}")
    exit(1)

print(f"ğŸ“‹ ì»¬ëŸ¼ ëª©ë¡: {list(df.columns)}")
print("")

features = []

for column in df.columns:
    print(f"ğŸ” ë¶„ì„ ì¤‘: {column}")
    
    # ê¸°ë³¸ ì •ë³´
    non_null_count = df[column].notna().sum()
    null_count = len(df) - non_null_count
    
    print(f"  - ìœ íš¨ ê°’: {non_null_count}, ê²°ì¸¡ê°’: {null_count}")
    
    # ë°ì´í„° íƒ€ì… ì¶”ë¡ 
    feature_type = "String"  # ê¸°ë³¸ê°’
    collection_type = None
    collection_config = None
    
    if non_null_count == 0:
        print("  âš ï¸ ëª¨ë“  ê°’ì´ ê²°ì¸¡ê°’ì…ë‹ˆë‹¤")
        feature_type = "String"
    else:
        # ìƒ˜í”Œ ê°’ë“¤ ë¶„ì„
        sample_values = df[column].dropna().head(100).tolist()
        
        # ìˆ˜ì¹˜í˜• íƒ€ì… í™•ì¸
        numeric_count = 0
        integer_count = 0
        
        for value in sample_values:
            try:
                float_val = float(value)
                numeric_count += 1
                if float_val.is_integer():
                    integer_count += 1
            except:
                pass
        
        numeric_ratio = numeric_count / len(sample_values) if sample_values else 0
        integer_ratio = integer_count / len(sample_values) if sample_values else 0
        
        print(f"  - ìˆ˜ì¹˜í˜• ë¹„ìœ¨: {numeric_ratio:.2%}")
        print(f"  - ì •ìˆ˜í˜• ë¹„ìœ¨: {integer_ratio:.2%}")
        
        # íƒ€ì… ê²°ì •
        if numeric_ratio > 0.8:  # 80% ì´ìƒì´ ìˆ˜ì¹˜í˜•
            if integer_ratio > 0.9:  # 90% ì´ìƒì´ ì •ìˆ˜
                feature_type = "Integral"
            else:
                feature_type = "Fractional"
        else:
            feature_type = "String"
            
            # ë¦¬ìŠ¤íŠ¸/ë°°ì—´ í˜•íƒœ í™•ì¸
            list_like_count = 0
            max_list_length = 0
            
            for value in sample_values[:20]:  # ì²˜ìŒ 20ê°œë§Œ ì²´í¬
                str_value = str(value)
                # JSON ë°°ì—´ í˜•íƒœ ì²´í¬
                if (str_value.startswith('[') and str_value.endswith(']')) or \
                   (str_value.startswith('{') and str_value.endswith('}')):
                    try:
                        parsed = json.loads(str_value)
                        if isinstance(parsed, list):
                            list_like_count += 1
                            max_list_length = max(max_list_length, len(parsed))
                    except:
                        pass
                # ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ê°’ë“¤ ì²´í¬
                elif ',' in str_value and len(str_value.split(',')) > 1:
                    list_like_count += 1
                    max_list_length = max(max_list_length, len(str_value.split(',')))
            
            list_ratio = list_like_count / min(len(sample_values), 20)
            print(f"  - ë¦¬ìŠ¤íŠ¸í˜• ë¹„ìœ¨: {list_ratio:.2%}")
            
            if list_ratio > 0.5:  # 50% ì´ìƒì´ ë¦¬ìŠ¤íŠ¸ í˜•íƒœ
                collection_type = "List"
                dimension = max(max_list_length, 10)  # ìµœì†Œ 10ì°¨ì›
                collection_config = {
                    "VectorConfig": {"Dimension": dimension}
                }
                print(f"  - ì¶”ì • ì°¨ì›: {dimension}")
    
    # íŠ¹ë³„í•œ ì»¬ëŸ¼ëª… íŒ¨í„´ ì²˜ë¦¬
    column_lower = column.lower()
    
    # event_time ê´€ë ¨
    if 'time' in column_lower or 'timestamp' in column_lower or 'date' in column_lower:
        if feature_type == "String":
            # íƒ€ì„ìŠ¤íƒ¬í”„ í˜•ì‹ í™•ì¸
            timestamp_count = 0
            for value in sample_values[:10]:
                str_value = str(value)
                # Unix timestamp (ìˆ«ì)
                if str_value.isdigit() and len(str_value) >= 10:
                    timestamp_count += 1
                # ISO format
                elif re.match(r'^\d{4}-\d{2}-\d{2}', str_value):
                    timestamp_count += 1
            
            if timestamp_count > len(sample_values[:10]) * 0.5:
                feature_type = "Fractional"  # Unix timestamp
                print("  ğŸ’¡ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ì¶”ì •í•˜ì—¬ Fractional íƒ€ì… ì ìš©")
    
    # ID ê´€ë ¨
    if 'id' in column_lower or column_lower.endswith('_id'):
        feature_type = "String"
        print("  ğŸ’¡ ID í•„ë“œë¡œ ì¶”ì •í•˜ì—¬ String íƒ€ì… ì ìš©")
    
    # Feature ê°ì²´ ìƒì„±
    feature = {
        "FeatureName": column,
        "FeatureType": feature_type
    }
    
    if collection_type:
        feature["CollectionType"] = collection_type
        if collection_config:
            feature["CollectionConfig"] = collection_config
    
    # ì„¤ëª… ì¶”ê°€
    description_parts = []
    if feature_type == "String":
        unique_count = df[column].nunique()
        description_parts.append(f"ê³ ìœ ê°’ {unique_count}ê°œ")
    elif feature_type in ["Integral", "Fractional"]:
        if non_null_count > 0:
            min_val = df[column].min()
            max_val = df[column].max()
            description_parts.append(f"ë²”ìœ„: {min_val}~{max_val}")
    
    if null_count > 0:
        null_ratio = null_count / len(df)
        description_parts.append(f"ê²°ì¸¡ë¥  {null_ratio:.1%}")
    
    if description_parts:
        feature["Description"] = f"ë°ì´í„° ë¶„ì„ ê¸°ë°˜ ì¶”ë¡  - " + ", ".join(description_parts)
    
    features.append(feature)
    print(f"  âœ… {column} -> {feature_type}" + (f" [{collection_type}]" if collection_type else ""))
    print("")

# í…œí”Œë¦¿ ì €ì¥
with open('$output_template', 'w', encoding='utf-8') as f:
    json.dump(features, f, indent=2, ensure_ascii=False)

print(f"âœ… í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ: $output_template")
print(f"ğŸ“Š ì´ {len(features)}ê°œ features ìƒì„±")

# íƒ€ì…ë³„ í†µê³„
type_counter = Counter(f['FeatureType'] for f in features)
print("")
print("ğŸ“ˆ Feature Type ë¶„í¬:")
for ftype, count in type_counter.items():
    print(f"  - {ftype}: {count}ê°œ")

collection_counter = Counter(f.get('CollectionType', 'None') for f in features)
if collection_counter.get('List', 0) > 0 or collection_counter.get('Set', 0) > 0:
    print("")
    print("ğŸ“¦ Collection Type ë¶„í¬:")
    for ctype, count in collection_counter.items():
        if ctype != 'None':
            print(f"  - {ctype}: {count}ê°œ")

EOF
    
    echo ""
    echo "âœ… CSV ê¸°ë°˜ í…œí”Œë¦¿ ì¶”ë¡  ì™„ë£Œ"
}

infer_from_json() {
    local json_file="$1"
    local output_template="$2" 
    local sample_size="$3"
    
    echo "ğŸ“„ JSON íŒŒì¼ ë¶„ì„ ì¤‘..."
    
    python3 << EOF
import json
from collections import Counter, defaultdict

# JSON íŒŒì¼ ì½ê¸°
try:
    with open('$json_file', 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    if isinstance(data, list):
        records = data[:$sample_size] if len(data) > $sample_size else data
        print(f"âœ… JSON ë°°ì—´ ë¡œë“œ: {len(records)} records")
    elif isinstance(data, dict):
        records = [data]
        print("âœ… JSON ê°ì²´ ë¡œë“œ: 1 record")
    else:
        print("âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” JSON êµ¬ì¡°")
        exit(1)
        
except Exception as e:
    print(f"âŒ JSON íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: {e}")
    exit(1)

# ëª¨ë“  í•„ë“œ ìˆ˜ì§‘
all_fields = defaultdict(list)

for record in records:
    if isinstance(record, dict):
        for key, value in record.items():
            all_fields[key].append(value)

print(f"ğŸ“‹ ë°œê²¬ëœ í•„ë“œ: {len(all_fields)}ê°œ")
print("")

features = []

for field_name, values in all_fields.items():
    print(f"ğŸ” ë¶„ì„ ì¤‘: {field_name}")
    
    # ë„ê°’ ì œê±°
    non_null_values = [v for v in values if v is not None]
    null_count = len(values) - len(non_null_values)
    
    print(f"  - ìœ íš¨ ê°’: {len(non_null_values)}, ë„ê°’: {null_count}")
    
    if not non_null_values:
        print("  âš ï¸ ëª¨ë“  ê°’ì´ ë„ê°’ì…ë‹ˆë‹¤")
        features.append({
            "FeatureName": field_name,
            "FeatureType": "String",
            "Description": "ëª¨ë“  ê°’ì´ nullì¸ í•„ë“œ"
        })
        continue
    
    # íƒ€ì… ë¶„ì„
    type_counter = Counter(type(v).__name__ for v in non_null_values)
    print(f"  - íƒ€ì… ë¶„í¬: {dict(type_counter)}")
    
    # Feature íƒ€ì… ê²°ì •
    feature_type = "String"
    collection_type = None
    collection_config = None
    
    # ê°€ì¥ ë§ì€ íƒ€ì…ìœ¼ë¡œ ê²°ì •
    most_common_type = type_counter.most_common(1)[0][0]
    
    if most_common_type in ['int', 'float']:
        if most_common_type == 'int' or all(isinstance(v, int) or (isinstance(v, float) and v.is_integer()) 
                                          for v in non_null_values):
            feature_type = "Integral"
        else:
            feature_type = "Fractional"
    elif most_common_type == 'list':
        feature_type = "String"
        collection_type = "List"
        
        # ë¦¬ìŠ¤íŠ¸ ì°¨ì› ë¶„ì„
        list_lengths = [len(v) for v in non_null_values if isinstance(v, list)]
        if list_lengths:
            avg_length = sum(list_lengths) // len(list_lengths)
            max_length = max(list_lengths)
            dimension = max_length if max_length <= 10000 else avg_length
            collection_config = {"VectorConfig": {"Dimension": dimension}}
            print(f"  - í‰ê·  ê¸¸ì´: {avg_length}, ìµœëŒ€ ê¸¸ì´: {max_length}")
            print(f"  - ì„¤ì • ì°¨ì›: {dimension}")
    else:
        feature_type = "String"
    
    # íŠ¹ë³„ í•„ë“œëª… ì²˜ë¦¬
    field_lower = field_name.lower()
    if 'time' in field_lower or 'timestamp' in field_lower:
        if isinstance(non_null_values[0], (int, float)):
            feature_type = "Fractional"
            print("  ğŸ’¡ íƒ€ì„ìŠ¤íƒ¬í”„ í•„ë“œë¡œ ì¸ì‹")
    
    # Feature ìƒì„±
    feature = {
        "FeatureName": field_name,
        "FeatureType": feature_type
    }
    
    if collection_type:
        feature["CollectionType"] = collection_type
        if collection_config:
            feature["CollectionConfig"] = collection_config
    
    # ì„¤ëª… ìƒì„±
    description_parts = [f"JSONì—ì„œ ì¶”ë¡  ({most_common_type} íƒ€ì…)"]
    if null_count > 0:
        null_ratio = null_count / len(values)
        description_parts.append(f"ë„ê°’ {null_ratio:.1%}")
    
    feature["Description"] = " - ".join(description_parts)
    features.append(feature)
    
    print(f"  âœ… {field_name} -> {feature_type}" + (f" [{collection_type}]" if collection_type else ""))
    print("")

# í…œí”Œë¦¿ ì €ì¥
with open('$output_template', 'w', encoding='utf-8') as f:
    json.dump(features, f, indent=2, ensure_ascii=False)

print(f"âœ… JSON ê¸°ë°˜ í…œí”Œë¦¿ ìƒì„± ì™„ë£Œ: $output_template")
print(f"ğŸ“Š ì´ {len(features)}ê°œ features")

EOF
}

# ì‚¬ìš© ì˜ˆì‹œ
echo "ğŸ” ë°ì´í„° ê¸°ë°˜ í…œí”Œë¦¿ ì¶”ë¡  ì‹œìŠ¤í…œ"
echo ""
echo "ì‚¬ìš©ë²•: infer_template_from_data <data_file> [output_template] [sample_size]"
echo ""
echo "ì§€ì› í˜•ì‹:"
echo "  - CSV íŒŒì¼ (.csv)"
echo "  - JSON íŒŒì¼ (.json)"
echo "  - Parquet íŒŒì¼ (.parquet)"
echo ""
echo "ì˜ˆì‹œ:"
echo "  infer_template_from_data data.csv"
echo "  infer_template_from_data data.json features.json"
echo "  infer_template_from_data big_data.csv inferred.json 5000"

# ì‹¤í–‰
if [ $# -gt 0 ]; then
    infer_template_from_data "$@"
fi
```

### 4. í…œí”Œë¦¿ ê²€ì¦ ë° ìµœì í™”

```bash
#!/bin/bash
# template_validator.sh - í…œí”Œë¦¿ ê²€ì¦ ë° ìµœì í™”

validate_and_optimize_template() {
    local template_file="$1"
    local optimized_file="${2:-optimized_${template_file}}"
    
    if [ ! -f "$template_file" ]; then
        echo "âŒ í…œí”Œë¦¿ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: $template_file"
        return 1
    fi
    
    echo "ğŸ” Feature í…œí”Œë¦¿ ê²€ì¦ ë° ìµœì í™”"
    echo "ì…ë ¥ í…œí”Œë¦¿: $template_file"
    echo "ìµœì í™”ëœ ì¶œë ¥: $optimized_file"
    echo ""
    
    # Pythonì„ ì‚¬ìš©í•œ ê²€ì¦ ë° ìµœì í™”
    python3 << EOF
import json
import re
from collections import Counter

def validate_feature_name(name):
    """Feature ì´ë¦„ ê²€ì¦"""
    issues = []
    
    # ê¸¸ì´ ì²´í¬
    if len(name) > 64:
        issues.append(f"ì´ë¦„ì´ ë„ˆë¬´ ê¹ë‹ˆë‹¤ ({len(name)}ì > 64ì)")
    
    # íŒ¨í„´ ì²´í¬
    if not re.match(r'^[a-zA-Z][a-zA-Z0-9_]*$', name):
        issues.append("ì´ë¦„ ê·œì¹™ ìœ„ë°˜ (ì˜ë¬¸ìë¡œ ì‹œì‘, ì˜ë¬¸/ìˆ«ì/ì–¸ë”ìŠ¤ì½”ì–´ë§Œ í—ˆìš©)")
    
    # ì˜ˆì•½ì–´ ì²´í¬
    reserved = ['time', 'date', 'timestamp', 'record', 'key', 'id', 'name']
    if name.lower() in reserved:
        issues.append(f"ì˜ˆì•½ì–´ ì‚¬ìš©: {name}")
    
    # ì—°ì† ì–¸ë”ìŠ¤ì½”ì–´ ì²´í¬
    if '__' in name:
        issues.append("ì—°ì†ëœ ì–¸ë”ìŠ¤ì½”ì–´ ì‚¬ìš©")
    
    return issues

def validate_feature_type(ftype):
    """Feature íƒ€ì… ê²€ì¦"""
    valid_types = ['String', 'Integral', 'Fractional']
    if ftype not in valid_types:
        return [f"ì˜ëª»ëœ FeatureType: {ftype}. ìœ íš¨í•œ ê°’: {valid_types}"]
    return []

def validate_collection_config(feature):
    """Collection ì„¤ì • ê²€ì¦"""
    issues = []
    collection_type = feature.get('CollectionType')
    
    if collection_type == 'List':
        config = feature.get('CollectionConfig', {})
        vector_config = config.get('VectorConfig', {})
        dimension = vector_config.get('Dimension')
        
        if not dimension:
            issues.append("List íƒ€ì…ì—ëŠ” Dimensionì´ í•„ìš”í•©ë‹ˆë‹¤")
        elif not isinstance(dimension, int) or dimension <= 0:
            issues.append(f"Dimensionì€ ì–‘ì˜ ì •ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤: {dimension}")
        elif dimension > 10000:
            issues.append(f"Dimensionì´ ë„ˆë¬´ í½ë‹ˆë‹¤: {dimension} (ê¶Œì¥: â‰¤ 10000)")
    
    elif collection_type and collection_type not in ['List', 'Set']:
        issues.append(f"ì˜ëª»ëœ CollectionType: {collection_type}")
    
    return issues

# í…œí”Œë¦¿ íŒŒì¼ ë¡œë“œ
try:
    with open('$template_file', 'r', encoding='utf-8') as f:
        template = json.load(f)
except Exception as e:
    print(f"âŒ í…œí”Œë¦¿ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: {e}")
    exit(1)

if not isinstance(template, list):
    print("âŒ í…œí”Œë¦¿ì€ ë°°ì—´ í˜•íƒœì—¬ì•¼ í•©ë‹ˆë‹¤")
    exit(1)

print(f"ğŸ“Š ì›ë³¸ í…œí”Œë¦¿: {len(template)}ê°œ features")
print("")

# ê²€ì¦ ê²°ê³¼
validation_results = {
    'errors': [],
    'warnings': [],
    'suggestions': []
}

valid_features = []
feature_names = set()

for i, feature in enumerate(template):
    if not isinstance(feature, dict):
        validation_results['errors'].append(f"Feature #{i+1}: ê°ì²´ í˜•íƒœê°€ ì•„ë‹™ë‹ˆë‹¤")
        continue
    
    feature_name = feature.get('FeatureName')
    if not feature_name:
        validation_results['errors'].append(f"Feature #{i+1}: FeatureNameì´ í•„ìš”í•©ë‹ˆë‹¤")
        continue
    
    print(f"ğŸ” ê²€ì¦ ì¤‘: {feature_name}")
    
    # ì¤‘ë³µ ì´ë¦„ ì²´í¬
    if feature_name in feature_names:
        validation_results['errors'].append(f"ì¤‘ë³µëœ Feature ì´ë¦„: {feature_name}")
        continue
    feature_names.add(feature_name)
    
    # ê°œë³„ ê²€ì¦
    name_issues = validate_feature_name(feature_name)
    type_issues = validate_feature_type(feature.get('FeatureType', ''))
    collection_issues = validate_collection_config(feature)
    
    feature_issues = name_issues + type_issues + collection_issues
    
    if feature_issues:
        for issue in feature_issues:
            validation_results['warnings'].append(f"{feature_name}: {issue}")
    
    # ìµœì í™”ëœ feature ìƒì„±
    optimized_feature = feature.copy()
    
    # ì´ë¦„ ìµœì í™”
    original_name = feature_name
    optimized_name = feature_name
    
    # ëŒ€ë¬¸ìë¥¼ ì†Œë¬¸ì+ì–¸ë”ìŠ¤ì½”ì–´ë¡œ ë³€ê²½ (camelCase -> snake_case)
    optimized_name = re.sub(r'([A-Z])', r'_\\1', optimized_name).lower().lstrip('_')
    
    # ì—°ì† ì–¸ë”ìŠ¤ì½”ì–´ ì œê±°
    optimized_name = re.sub(r'_{2,}', '_', optimized_name)
    
    # ì‹œì‘/ë ì–¸ë”ìŠ¤ì½”ì–´ ì œê±°
    optimized_name = optimized_name.strip('_')
    
    if optimized_name != original_name:
        validation_results['suggestions'].append(f"ì´ë¦„ ìµœì í™”: {original_name} -> {optimized_name}")
        optimized_feature['FeatureName'] = optimized_name
    
    # Description ì¶”ê°€/ê°œì„ 
    if not optimized_feature.get('Description'):
        ftype = optimized_feature.get('FeatureType', 'String')
        collection = optimized_feature.get('CollectionType', '')
        
        auto_description = f"{ftype} íƒ€ì…"
        if collection:
            if collection == 'List':
                dimension = optimized_feature.get('CollectionConfig', {}).get('VectorConfig', {}).get('Dimension', 0)
                auto_description += f", {dimension}ì°¨ì› ë²¡í„°"
            else:
                auto_description += f", {collection} ì»¬ë ‰ì…˜"
        
        optimized_feature['Description'] = f"ìë™ ìƒì„± ì„¤ëª…: {auto_description}"
        validation_results['suggestions'].append(f"{feature_name}: ì„¤ëª… ìë™ ì¶”ê°€")
    
    valid_features.append(optimized_feature)
    print(f"  âœ… ê²€ì¦ ì™„ë£Œ")

print("")

# í†µê³„ ë¶„ì„
type_counter = Counter(f.get('FeatureType', 'Unknown') for f in valid_features)
collection_counter = Counter(f.get('CollectionType', 'None') for f in valid_features)

print("ğŸ“ˆ Feature Type ë¶„í¬:")
for ftype, count in type_counter.items():
    print(f"  - {ftype}: {count}ê°œ")

print("")
print("ğŸ“¦ Collection Type ë¶„í¬:")
for ctype, count in collection_counter.items():
    print(f"  - {ctype}: {count}ê°œ")

# ê¶Œì¥ì‚¬í•­
print("")
print("ğŸ’¡ ìµœì í™” ê¶Œì¥ì‚¬í•­:")

if len(valid_features) > 50:
    validation_results['suggestions'].append("Feature ìˆ˜ê°€ ë§ìŠµë‹ˆë‹¤ (50ê°œ ì´ˆê³¼). ë…¼ë¦¬ì  ê·¸ë£¹í•‘ì„ ê³ ë ¤í•˜ì„¸ìš”")

string_ratio = type_counter.get('String', 0) / len(valid_features) if valid_features else 0
if string_ratio > 0.8:
    validation_results['suggestions'].append(f"String íƒ€ì… ë¹„ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤ ({string_ratio:.1%}). ë‹¤ë¥¸ íƒ€ì… ê³ ë ¤í•´ë³´ì„¸ìš”")

vector_count = collection_counter.get('List', 0)
if vector_count > 10:
    validation_results['suggestions'].append(f"ë²¡í„° Featureê°€ ë§ìŠµë‹ˆë‹¤ ({vector_count}ê°œ). ì„±ëŠ¥ ì˜í–¥ì„ ê³ ë ¤í•˜ì„¸ìš”")

# ê²°ê³¼ ì¶œë ¥
print("")
print("ğŸ¯ ê²€ì¦ ê²°ê³¼")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")

if validation_results['errors']:
    print(f"âŒ ì˜¤ë¥˜ ({len(validation_results['errors'])}ê°œ):")
    for error in validation_results['errors']:
        print(f"  - {error}")
    print("")

if validation_results['warnings']:
    print(f"âš ï¸  ê²½ê³  ({len(validation_results['warnings'])}ê°œ):")
    for warning in validation_results['warnings']:
        print(f"  - {warning}")
    print("")

if validation_results['suggestions']:
    print(f"ğŸ’¡ ì œì•ˆ ({len(validation_results['suggestions'])}ê°œ):")
    for suggestion in validation_results['suggestions']:
        print(f"  - {suggestion}")
    print("")

# ìµœì í™”ëœ í…œí”Œë¦¿ ì €ì¥
try:
    with open('$optimized_file', 'w', encoding='utf-8') as f:
        json.dump(valid_features, f, indent=2, ensure_ascii=False)
    
    print(f"âœ… ìµœì í™”ëœ í…œí”Œë¦¿ ì €ì¥: $optimized_file")
    print(f"ğŸ“Š ìœ íš¨í•œ Features: {len(valid_features)}ê°œ")
    
    # í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
    total_checks = len(validation_results['errors']) + len(validation_results['warnings'])
    error_penalty = len(validation_results['errors']) * 2
    warning_penalty = len(validation_results['warnings'])
    
    max_score = 100
    penalty = error_penalty + warning_penalty
    quality_score = max(0, max_score - penalty)
    
    print(f"ğŸ† í’ˆì§ˆ ì ìˆ˜: {quality_score}/100")
    
    if quality_score >= 90:
        print("  ğŸ‰ ìš°ìˆ˜í•œ í…œí”Œë¦¿ì…ë‹ˆë‹¤!")
    elif quality_score >= 70:
        print("  ğŸ‘ ì–‘í˜¸í•œ í…œí”Œë¦¿ì…ë‹ˆë‹¤.")
    elif quality_score >= 50:
        print("  âš ï¸  ê°œì„ ì´ í•„ìš”í•œ í…œí”Œë¦¿ì…ë‹ˆë‹¤.")
    else:
        print("  ğŸš¨ ì‹¬ê°í•œ ë¬¸ì œê°€ ìˆëŠ” í…œí”Œë¦¿ì…ë‹ˆë‹¤.")

except Exception as e:
    print(f"âŒ ìµœì í™”ëœ í…œí”Œë¦¿ ì €ì¥ ì‹¤íŒ¨: {e}")

EOF
    
    echo ""
    echo "âœ… í…œí”Œë¦¿ ê²€ì¦ ë° ìµœì í™” ì™„ë£Œ"
}

# ì‚¬ìš© ì˜ˆì‹œ
echo "ğŸ” Feature í…œí”Œë¦¿ ê²€ì¦ ë° ìµœì í™” ë„êµ¬"
echo ""
echo "ì‚¬ìš©ë²•: validate_and_optimize_template <template_file> [optimized_output]"
echo ""
echo "ì˜ˆì‹œ:"
echo "  validate_and_optimize_template my_features.json"
echo "  validate_and_optimize_template draft.json final_features.json"

if [ $# -gt 0 ]; then
    validate_and_optimize_template "$@"
fi
```

## ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ

### ì¼ë°˜ì ì¸ í…œí”Œë¦¿ ì‚¬ìš© ì›Œí¬í”Œë¡œìš°

```bash
#!/bin/bash
# complete_template_workflow.sh - ì™„ì „í•œ í…œí”Œë¦¿ ì›Œí¬í”Œë¡œìš°

echo "ğŸ¯ Feature Definition ì™„ì „ ì›Œí¬í”Œë¡œìš°"
echo ""

# 1. ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„±
echo "1ï¸âƒ£ ê¸°ë³¸ í…œí”Œë¦¿ ìƒì„±"
fs schema-template --output base_template.json
echo ""

# 2. í…œí”Œë¦¿ í¸ì§‘
echo "2ï¸âƒ£ í…œí”Œë¦¿ í¸ì§‘ (ì›í•˜ëŠ” featuresë¡œ ìˆ˜ì •)"
echo "   í¸ì§‘ê¸°ê°€ ì—´ë¦½ë‹ˆë‹¤..."
${EDITOR:-vim} base_template.json
echo ""

# 3. í…œí”Œë¦¿ ê²€ì¦
echo "3ï¸âƒ£ í…œí”Œë¦¿ ê²€ì¦"
./template_validator.sh base_template.json validated_template.json
echo ""

# 4. Feature Group ì„ íƒ
echo "4ï¸âƒ£ Feature Group ì„ íƒ"
echo "ì‚¬ìš© ê°€ëŠ¥í•œ Feature Groups:"
fs list
echo ""
read -p "Feature Group ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”: " feature_group_name

# 5. í˜¸í™˜ì„± í™•ì¸
echo ""
echo "5ï¸âƒ£ í˜¸í™˜ì„± í™•ì¸ (dry-run)"
fs add-features "$feature_group_name" validated_template.json --dry-run
echo ""

# 6. ìµœì¢… í™•ì¸
echo "6ï¸âƒ£ ìµœì¢… í™•ì¸"
read -p "Featureë¥¼ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): " confirm

if [[ $confirm =~ ^[Yy]$ ]]; then
    echo ""
    echo "7ï¸âƒ£ Feature ì¶”ê°€ ì‹¤í–‰"
    fs add-features "$feature_group_name" validated_template.json
    
    echo ""
    echo "8ï¸âƒ£ ê²°ê³¼ í™•ì¸"
    fs schema "$feature_group_name"
else
    echo "âŒ Feature ì¶”ê°€ê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤"
fi

echo ""
echo "âœ… ì›Œí¬í”Œë¡œìš° ì™„ë£Œ!"
```

## ê´€ë ¨ ëª…ë ¹ì–´

- [`add-features`](12.add-features.md) - í…œí”Œë¦¿ìœ¼ë¡œ ìƒˆë¡œìš´ feature ì¶”ê°€
- [`schema`](13.schema.md) - í˜„ì¬ Feature Group ìŠ¤í‚¤ë§ˆ ì¡°íšŒ
- [`create`](02.create.md) - ìƒˆ Feature Group ìƒì„± ì‹œ ìŠ¤í‚¤ë§ˆ ì •ì˜

## ì°¸ê³ ì‚¬í•­

- **í‘œì¤€ êµ¬ì¡°**: ëª¨ë“  SageMaker Feature Store feature definition ìš”ì†Œë¥¼ í¬í•¨í•©ë‹ˆë‹¤
- **ì˜ˆì‹œ ì¤‘ì‹¬**: ê° íƒ€ì…ê³¼ ì„¤ì •ì— ëŒ€í•œ ì‹¤ìš©ì ì¸ ì˜ˆì‹œë¥¼ ì œê³µí•©ë‹ˆë‹¤
- **í¸ì§‘ ê°€ëŠ¥**: ìƒì„±ëœ í…œí”Œë¦¿ì€ ìš©ë„ì— ë§ê²Œ ììœ ë¡­ê²Œ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- **ê²€ì¦ ë„êµ¬**: ë³„ë„ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ í’ˆì§ˆì„ ë³´ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤