# 13. schema ëª…ë ¹ì–´

Feature Groupì˜ í˜„ì¬ ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

## ê¸°ë³¸ ì‚¬ìš©ë²•

```bash
# í…Œì´ë¸” í˜•íƒœë¡œ ìŠ¤í‚¤ë§ˆ ì¶œë ¥
fs schema my-feature-group

# JSON í˜•íƒœë¡œ ìŠ¤í‚¤ë§ˆ ì¶œë ¥
fs schema my-feature-group --output-format json
```

## ëª…ë ¹ì–´ ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `FEATURE_GROUP_NAME` | ì¡°íšŒí•  Feature Group ì´ë¦„ (í•„ìˆ˜) | - |
| `--output-format`, `-o` | ì¶œë ¥ í˜•ì‹ (table, json) | table |

## ì¶œë ¥ ì •ë³´

### ê¸°ë³¸ ì •ë³´
- **Feature Group ì´ë¦„**: ì¡°íšŒ ëŒ€ìƒ Feature Group
- **ìƒíƒœ**: Feature Groupì˜ í˜„ì¬ ìƒíƒœ (Created, Creating, UpdateFailed ë“±)
- **Record Identifier**: ë ˆì½”ë“œ ì‹ë³„ì feature ì´ë¦„
- **Event Time Feature**: ì´ë²¤íŠ¸ ì‹œê°„ feature ì´ë¦„
- **Total Features**: ì „ì²´ feature ê°œìˆ˜

### Feature ìƒì„¸ ì •ë³´
- **Feature Name**: ê° featureì˜ ì´ë¦„
- **Type**: ë°ì´í„° íƒ€ì… (String, Integral, Fractional)
- **Collection Type**: ì»¬ë ‰ì…˜ íƒ€ì… (List, Set)
- **Collection Name**: ì»¬ë ‰ì…˜ ì„¤ì • ì •ë³´

## ìƒì„¸ ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ë³¸ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ (í…Œì´ë¸” í˜•íƒœ)

```bash
fs schema customer-profiles

# ì¶œë ¥ ì˜ˆì‹œ:
# ğŸ“Š Feature Group: customer-profiles
# Status: Created
# Record Identifier: customer_id
# Event Time Feature: event_time
# Total Features: 8
# 
# ğŸ“‹ Feature Definitions:
# --------------------------------------------------------------------------------
# Feature Name                   Type            Collection Type Collection Name
# --------------------------------------------------------------------------------
# customer_id                    String                          
# customer_name                  String                          
# age                           Integral                         
# income                        Fractional                       
# customer_segment              String                          
# purchase_history              String          List            100
# preferred_categories          String          Set             Set
# event_time                    Fractional                       
```

### JSON í˜•íƒœë¡œ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ

```bash
fs schema customer-profiles --format json

# ì¶œë ¥ ì˜ˆì‹œ:
# {
#   "FeatureGroupName": "customer-profiles",
#   "FeatureGroupStatus": "Created", 
#   "RecordIdentifierFeatureName": "customer_id",
#   "EventTimeFeatureName": "event_time",
#   "FeatureDefinitions": [
#     {
#       "FeatureName": "customer_id",
#       "FeatureType": "String"
#     },
#     {
#       "FeatureName": "customer_name", 
#       "FeatureType": "String"
#     },
#     {
#       "FeatureName": "age",
#       "FeatureType": "Integral"
#     },
#     {
#       "FeatureName": "purchase_history",
#       "FeatureType": "String",
#       "CollectionType": "List",
#       "CollectionConfig": {
#         "VectorConfig": {
#           "Dimension": 100
#         }
#       }
#     }
#   ],
#   "TotalFeatures": 8
# }
```

## ê³ ê¸‰ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

### 1. ìŠ¤í‚¤ë§ˆ ë¹„êµ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# schema_comparison.sh - ì—¬ëŸ¬ Feature Group ìŠ¤í‚¤ë§ˆ ë¹„êµ

compare_schemas() {
    local feature_groups=("$@")
    
    if [ ${#feature_groups[@]} -lt 2 ]; then
        echo "ë¹„êµë¥¼ ìœ„í•´ ìµœì†Œ 2ê°œì˜ Feature Groupì´ í•„ìš”í•©ë‹ˆë‹¤"
        return 1
    fi
    
    echo "ğŸ“Š Feature Group ìŠ¤í‚¤ë§ˆ ë¹„êµ"
    echo "ë¹„êµ ëŒ€ìƒ: ${feature_groups[*]}"
    echo ""
    
    # ì„ì‹œ íŒŒì¼ë“¤
    temp_dir="/tmp/schema_comparison_$(date +%Y%m%d_%H%M%S)"
    mkdir -p "$temp_dir"
    
    # ê° Feature Groupì˜ ìŠ¤í‚¤ë§ˆ ìˆ˜ì§‘
    for fg in "${feature_groups[@]}"; do
        echo "ğŸ“‹ $fg ìŠ¤í‚¤ë§ˆ ìˆ˜ì§‘ ì¤‘..."
        
        schema_file="$temp_dir/${fg}_schema.json"
        
        if fs schema "$fg" --format json > "$schema_file"; then
            echo "  âœ… $fg ìŠ¤í‚¤ë§ˆ ìˆ˜ì§‘ ì™„ë£Œ"
        else
            echo "  âŒ $fg ìŠ¤í‚¤ë§ˆ ìˆ˜ì§‘ ì‹¤íŒ¨"
            rm -rf "$temp_dir"
            return 1
        fi
    done
    
    echo ""
    
    # Pythonì„ ì‚¬ìš©í•œ ìƒì„¸ ë¹„êµ
    python3 << EOF
import json
import os
from collections import defaultdict

temp_dir = "$temp_dir"
feature_groups = ["${feature_groups[@]}".split()]

# ìŠ¤í‚¤ë§ˆ ë°ì´í„° ë¡œë“œ
schemas = {}
for fg in feature_groups:
    schema_file = os.path.join(temp_dir, f"{fg}_schema.json")
    with open(schema_file, 'r') as f:
        schemas[fg] = json.load(f)

print("ğŸ” ìŠ¤í‚¤ë§ˆ ë¹„êµ ë¶„ì„")
print("=" * 60)
print("")

# ê¸°ë³¸ ì •ë³´ ë¹„êµ
print("ğŸ“Š ê¸°ë³¸ ì •ë³´ ë¹„êµ")
print("-" * 40)
print(f"{'Feature Group':<25} {'Features':<10} {'Status':<15} {'Record ID':<20}")
print("-" * 70)

for fg in feature_groups:
    schema = schemas[fg]
    feature_count = schema.get('TotalFeatures', 0)
    status = schema.get('FeatureGroupStatus', 'Unknown')
    record_id = schema.get('RecordIdentifierFeatureName', 'N/A')
    
    print(f"{fg:<25} {feature_count:<10} {status:<15} {record_id:<20}")

print("")

# Feature ìœ í˜•ë³„ ë¶„í¬ ë¹„êµ
print("ğŸ“ˆ Feature Type ë¶„í¬ ë¹„êµ")
print("-" * 40)

type_distributions = {}
for fg in feature_groups:
    type_dist = defaultdict(int)
    features = schemas[fg].get('FeatureDefinitions', [])
    
    for feature in features:
        ftype = feature.get('FeatureType', 'Unknown')
        type_dist[ftype] += 1
    
    type_distributions[fg] = dict(type_dist)

# ëª¨ë“  íƒ€ì… ìˆ˜ì§‘
all_types = set()
for dist in type_distributions.values():
    all_types.update(dist.keys())

print(f"{'Type':<15} " + " ".join([f"{fg:<12}" for fg in feature_groups]))
print("-" * (15 + 12 * len(feature_groups) + len(feature_groups) - 1))

for ftype in sorted(all_types):
    row = f"{ftype:<15}"
    for fg in feature_groups:
        count = type_distributions[fg].get(ftype, 0)
        row += f" {count:<12}"
    print(row)

print("")

# ê³µí†µ Feature ë¶„ì„
print("ğŸ¤ ê³µí†µ Features ë¶„ì„")
print("-" * 40)

# ê° Feature Groupì˜ feature ì´ë¦„ ìˆ˜ì§‘
feature_sets = {}
for fg in feature_groups:
    features = schemas[fg].get('FeatureDefinitions', [])
    feature_sets[fg] = {f['FeatureName'] for f in features}

# êµì§‘í•© (ëª¨ë“  FGì— ê³µí†µìœ¼ë¡œ ìˆëŠ” features)
common_features = set.intersection(*feature_sets.values())
print(f"ëª¨ë“  Feature Groupì— ê³µí†µ: {len(common_features)}ê°œ")
for feature in sorted(common_features):
    print(f"  âœ“ {feature}")

print("")

# ì°¨ì§‘í•© (ê° FGì—ë§Œ ìˆëŠ” unique features)
print("ğŸ¯ ê³ ìœ  Features")
print("-" * 40)

for fg in feature_groups:
    unique_features = feature_sets[fg]
    for other_fg in feature_groups:
        if other_fg != fg:
            unique_features = unique_features - feature_sets[other_fg]
    
    print(f"{fg}ì—ë§Œ ìˆëŠ” features: {len(unique_features)}ê°œ")
    for feature in sorted(unique_features):
        print(f"  + {feature}")
    print("")

# Collection Type ë¶„ì„
print("ğŸ“¦ Collection Type ë¶„ì„")
print("-" * 40)

collection_analysis = {}
for fg in feature_groups:
    features = schemas[fg].get('FeatureDefinitions', [])
    collection_count = {"List": 0, "Set": 0, "None": 0}
    
    for feature in features:
        collection_type = feature.get('CollectionType')
        if collection_type:
            collection_count[collection_type] += 1
        else:
            collection_count["None"] += 1
    
    collection_analysis[fg] = collection_count

print(f"{'FG / Collection':<25} {'List':<8} {'Set':<8} {'None':<8}")
print("-" * 49)

for fg in feature_groups:
    counts = collection_analysis[fg]
    print(f"{fg:<25} {counts['List']:<8} {counts['Set']:<8} {counts['None']:<8}")

print("")

# ìŠ¤í‚¤ë§ˆ ì§„í™” ê¶Œì¥ì‚¬í•­
print("ğŸ’¡ ìŠ¤í‚¤ë§ˆ ì§„í™” ê¶Œì¥ì‚¬í•­")
print("-" * 40)

# Feature ìˆ˜ ê· í˜•
feature_counts = [schemas[fg]['TotalFeatures'] for fg in feature_groups]
min_features = min(feature_counts)
max_features = max(feature_counts)

if max_features - min_features > 10:
    print("1. Feature ìˆ˜ ë¶ˆê· í˜• ê°ì§€:")
    print(f"   ìµœì†Œ: {min_features}ê°œ, ìµœëŒ€: {max_features}ê°œ")
    print("   â†’ Feature Group ì—­í•  ì¬ê²€í†  í•„ìš”")

# ê³µí†µ feature ë¶€ì¡±
if len(common_features) < 3:
    print("2. ê³µí†µ Feature ë¶€ì¡±:")
    print(f"   í˜„ì¬ ê³µí†µ features: {len(common_features)}ê°œ")
    print("   â†’ í†µí•© ë¶„ì„ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤")

# íƒ€ì… ë¶ˆì¼ì¹˜ í™•ì¸
type_inconsistencies = []
for feature_name in common_features:
    types = set()
    for fg in feature_groups:
        features = schemas[fg].get('FeatureDefinitions', [])
        for feature in features:
            if feature['FeatureName'] == feature_name:
                types.add(feature['FeatureType'])
    
    if len(types) > 1:
        type_inconsistencies.append((feature_name, types))

if type_inconsistencies:
    print("3. ê³µí†µ Feature íƒ€ì… ë¶ˆì¼ì¹˜:")
    for feature_name, types in type_inconsistencies:
        print(f"   {feature_name}: {types}")
    print("   â†’ íƒ€ì… í†µì¼ì„ ê³ ë ¤í•´ë³´ì„¸ìš”")

if not any([max_features - min_features > 10, len(common_features) < 3, type_inconsistencies]):
    print("âœ… ìŠ¤í‚¤ë§ˆë“¤ì´ ì¼ê´€ì„± ìˆê²Œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤!")

EOF
    
    echo ""
    echo "ğŸ“ ìŠ¤í‚¤ë§ˆ íŒŒì¼ë“¤: $temp_dir"
    echo "ğŸ”— ë¹„êµ ì™„ë£Œ"
    
    # ì •ë¦¬ ì˜µì…˜
    echo ""
    echo "ì„ì‹œ íŒŒì¼ë“¤ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N)"
    read -r cleanup_temp
    
    if [[ $cleanup_temp =~ ^[Yy]$ ]]; then
        rm -rf "$temp_dir"
        echo "âœ… ì„ì‹œ íŒŒì¼ ì •ë¦¬ ì™„ë£Œ"
    else
        echo "ğŸ“ ì„ì‹œ íŒŒì¼ ë³´ê´€: $temp_dir"
    fi
}

# ì‚¬ìš© ì˜ˆì‹œ
compare_schemas "user-profiles" "customer-data" "analytics-features"
```

### 2. ìŠ¤í‚¤ë§ˆ ì§„í™” ì¶”ì  ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# schema_evolution_tracker.sh - ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì¶”ì  ì‹œìŠ¤í…œ

track_schema_evolution() {
    local feature_group="$1"
    local tracking_dir="schema_tracking/$feature_group"
    
    if [ -z "$feature_group" ]; then
        echo "ì‚¬ìš©ë²•: track_schema_evolution <feature-group-name>"
        return 1
    fi
    
    echo "ğŸ“ˆ ìŠ¤í‚¤ë§ˆ ì§„í™” ì¶”ì : $feature_group"
    
    # ì¶”ì  ë””ë ‰í† ë¦¬ ìƒì„±
    mkdir -p "$tracking_dir"
    
    # í˜„ì¬ ìŠ¤í‚¤ë§ˆ ì €ì¥
    timestamp=$(date +%Y%m%d_%H%M%S)
    current_schema="$tracking_dir/schema_$timestamp.json"
    
    echo "ğŸ’¾ í˜„ì¬ ìŠ¤í‚¤ë§ˆ ì €ì¥ ì¤‘..."
    if fs schema "$feature_group" --format json > "$current_schema"; then
        echo "âœ… ìŠ¤í‚¤ë§ˆ ì €ì¥ ì™„ë£Œ: $current_schema"
    else
        echo "âŒ ìŠ¤í‚¤ë§ˆ ì €ì¥ ì‹¤íŒ¨"
        return 1
    fi
    
    # ì´ì „ ìŠ¤í‚¤ë§ˆë“¤ê³¼ ë¹„êµ
    previous_schemas=($(ls -t "$tracking_dir"/schema_*.json 2>/dev/null | tail -n +2))
    
    if [ ${#previous_schemas[@]} -eq 0 ]; then
        echo "â„¹ï¸  ì²« ë²ˆì§¸ ìŠ¤í‚¤ë§ˆ ìŠ¤ëƒ…ìƒ·ì…ë‹ˆë‹¤"
        
        # ì§„í™” ë¡œê·¸ ì´ˆê¸°í™”
        evolution_log="$tracking_dir/evolution.log"
        echo "$(date '+%Y-%m-%d %H:%M:%S') | INIT | First schema snapshot" >> "$evolution_log"
        
        return 0
    fi
    
    # ê°€ì¥ ìµœê·¼ ì´ì „ ìŠ¤í‚¤ë§ˆì™€ ë¹„êµ
    previous_schema="${previous_schemas[0]}"
    
    echo ""
    echo "ğŸ”„ ì´ì „ ìŠ¤í‚¤ë§ˆì™€ ë¹„êµ ì¤‘..."
    echo "  í˜„ì¬: $(basename $current_schema)"
    echo "  ì´ì „: $(basename $previous_schema)"
    
    # Pythonì„ ì‚¬ìš©í•œ ìƒì„¸ ë¹„êµ
    python3 << EOF
import json
from datetime import datetime

# ìŠ¤í‚¤ë§ˆ ë¡œë“œ
with open('$current_schema', 'r') as f:
    current = json.load(f)
with open('$previous_schema', 'r') as f:
    previous = json.load(f)

# Feature ì •ë³´ ì¶”ì¶œ
current_features = {f['FeatureName']: f for f in current['FeatureDefinitions']}
previous_features = {f['FeatureName']: f for f in previous['FeatureDefinitions']}

current_names = set(current_features.keys())
previous_names = set(previous_features.keys())

# ë³€ê²½ ì‚¬í•­ ë¶„ì„
added_features = current_names - previous_names
removed_features = previous_names - current_names
common_features = current_names & previous_names

print("")
print("ğŸ“‹ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‚¬í•­ ë¶„ì„")
print("-" * 40)

# í†µê³„ ìš”ì•½
print(f"ì´ì „ features: {len(previous_features)}")
print(f"í˜„ì¬ features: {len(current_features)}")
print(f"ë³€ê²½ëœ features: {len(added_features) + len(removed_features)}")

evolution_events = []

# ì¶”ê°€ëœ features
if added_features:
    print(f"\nâ• ì¶”ê°€ëœ Features ({len(added_features)}ê°œ):")
    for feature_name in sorted(added_features):
        feature = current_features[feature_name]
        ftype = feature.get('FeatureType', 'Unknown')
        collection = feature.get('CollectionType', '')
        collection_info = f" [{collection}]" if collection else ""
        
        print(f"  + {feature_name} ({ftype}{collection_info})")
        evolution_events.append(f"ADD|{feature_name}|{ftype}{collection_info}")

# ì œê±°ëœ features (ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ì§€ ì•ŠìŒ)
if removed_features:
    print(f"\nâ– ì œê±°ëœ Features ({len(removed_features)}ê°œ):")
    for feature_name in sorted(removed_features):
        feature = previous_features[feature_name]
        ftype = feature.get('FeatureType', 'Unknown')
        print(f"  - {feature_name} ({ftype})")
        evolution_events.append(f"REMOVE|{feature_name}|{ftype}")

# íƒ€ì… ë³€ê²½ í™•ì¸ (ë“œë¬¼ì§€ë§Œ ê°€ëŠ¥)
type_changes = []
for feature_name in common_features:
    current_type = current_features[feature_name].get('FeatureType')
    previous_type = previous_features[feature_name].get('FeatureType')
    
    if current_type != previous_type:
        type_changes.append({
            'name': feature_name,
            'from': previous_type,
            'to': current_type
        })

if type_changes:
    print(f"\nğŸ”„ íƒ€ì… ë³€ê²½ëœ Features ({len(type_changes)}ê°œ):")
    for change in type_changes:
        print(f"  ~ {change['name']}: {change['from']} â†’ {change['to']}")
        evolution_events.append(f"CHANGE|{change['name']}|{change['from']}â†’{change['to']}")

# ë³€ê²½ì‚¬í•­ì´ ì—†ëŠ” ê²½ìš°
if not added_features and not removed_features and not type_changes:
    print("\nâœ… ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì—†ìŒ")
    evolution_events.append("NO_CHANGE")

# ì§„í™” ì´ë²¤íŠ¸ ë¡œê·¸ ì €ì¥
if evolution_events:
    log_file = "$tracking_dir/evolution.log"
    timestamp_str = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    
    for event in evolution_events:
        with open(log_file, 'a') as f:
            f.write(f"{timestamp_str} | {event}\n")

print("")
print("ğŸ“Š ì§„í™” í†µê³„:")
print(f"  ì´ ìŠ¤ëƒ…ìƒ·: {len([f for f in '$(ls $tracking_dir/schema_*.json 2>/dev/null | wc -l)'.split()]) + 1}")
print(f"  ì¶”ê°€ events: {len([e for e in evolution_events if e.startswith('ADD')])}")
print(f"  ë³€ê²½ events: {len([e for e in evolution_events if e.startswith('CHANGE')])}")

EOF
    
    # ì§„í™” íˆìŠ¤í† ë¦¬ í‘œì‹œ
    echo ""
    echo "ğŸ“š ìµœê·¼ ì§„í™” íˆìŠ¤í† ë¦¬:"
    evolution_log="$tracking_dir/evolution.log"
    if [ -f "$evolution_log" ]; then
        tail -10 "$evolution_log" | while read -r line; do
            echo "  $line"
        done
    fi
    
    # ì§„í™” ìš”ì•½ ë¦¬í¬íŠ¸ ìƒì„±
    summary_report="$tracking_dir/evolution_summary.txt"
    
    cat > "$summary_report" << EOF
# Schema Evolution Summary: $feature_group

ìƒì„±ì¼: $(date)
ì¶”ì  ì‹œì‘: $(head -1 "$evolution_log" 2>/dev/null | cut -d'|' -f1 || echo "Unknown")
ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: $(tail -1 "$evolution_log" 2>/dev/null | cut -d'|' -f1 || echo "Unknown")

## í˜„ì¬ ìƒíƒœ
$(fs schema "$feature_group" 2>/dev/null | head -10)

## ìµœê·¼ ë³€ê²½ ì´ë ¥
$(tail -10 "$evolution_log" 2>/dev/null || echo "ë³€ê²½ ì´ë ¥ ì—†ìŒ")

## ìŠ¤ëƒ…ìƒ· íŒŒì¼ë“¤
$(ls -la "$tracking_dir"/schema_*.json 2>/dev/null || echo "ìŠ¤ëƒ…ìƒ· ì—†ìŒ")
EOF
    
    echo ""
    echo "ğŸ“„ ì§„í™” ìš”ì•½ ë¦¬í¬íŠ¸ ì—…ë°ì´íŠ¸ë¨: $summary_report"
    
    # ì˜¤ë˜ëœ ìŠ¤ëƒ…ìƒ· ì •ë¦¬ (30ì¼ ì´ìƒ)
    old_snapshots=$(find "$tracking_dir" -name "schema_*.json" -mtime +30 2>/dev/null)
    if [ -n "$old_snapshots" ]; then
        echo ""
        echo "ğŸ—‘ï¸  ì˜¤ë˜ëœ ìŠ¤ëƒ…ìƒ· ì •ë¦¬ (30ì¼ ì´ìƒ):"
        echo "$old_snapshots" | while read -r old_file; do
            echo "  ì‚­ì œ: $(basename "$old_file")"
            rm -f "$old_file"
        done
    fi
    
    echo ""
    echo "âœ… ìŠ¤í‚¤ë§ˆ ì§„í™” ì¶”ì  ì™„ë£Œ"
    echo "ğŸ“ ì¶”ì  ë””ë ‰í† ë¦¬: $tracking_dir"
}

# ì‚¬ìš© ì˜ˆì‹œ
track_schema_evolution "my-feature-group"

# ìë™ ì¶”ì ì„ ìœ„í•œ cron ì„¤ì • ì˜ˆì‹œ
# ë§¤ì¼ ì˜¤ì „ 6ì‹œì— ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì¶”ì 
# 0 6 * * * /path/to/schema_evolution_tracker.sh "my-feature-group" >> /var/log/schema_tracking.log 2>&1
```

### 3. ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹œìŠ¤í…œ

```bash
#!/bin/bash
# schema_validator.sh - Feature Group ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹œìŠ¤í…œ

validate_schema() {
    local feature_group="$1"
    local validation_profile="${2:-standard}"  # standard, strict, ml, business
    
    if [ -z "$feature_group" ]; then
        echo "ì‚¬ìš©ë²•: validate_schema <feature-group-name> [validation-profile]"
        echo "Profiles: standard, strict, ml, business"
        return 1
    fi
    
    echo "ğŸ” ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹œìŠ¤í…œ"
    echo "Feature Group: $feature_group"
    echo "ê²€ì¦ í”„ë¡œí•„: $validation_profile"
    echo ""
    
    # ìŠ¤í‚¤ë§ˆ ì •ë³´ ìˆ˜ì§‘
    temp_schema="/tmp/${feature_group}_schema_validation.json"
    
    if ! fs schema "$feature_group" --format json > "$temp_schema"; then
        echo "âŒ ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
        return 1
    fi
    
    # Pythonì„ ì‚¬ìš©í•œ ìƒì„¸ ê²€ì¦
    python3 << EOF
import json
import re
from collections import Counter, defaultdict

# ê²€ì¦ í”„ë¡œí•„ ì„¤ì •
VALIDATION_PROFILES = {
    'standard': {
        'max_features': 100,
        'max_feature_name_length': 64,
        'required_features': ['event_time'],
        'discouraged_types': [],
        'max_vector_dimension': 1000,
        'naming_pattern': r'^[a-zA-Z][a-zA-Z0-9_]*$'
    },
    'strict': {
        'max_features': 50,
        'max_feature_name_length': 32,
        'required_features': ['event_time', 'record_id'],
        'discouraged_types': [],
        'max_vector_dimension': 512,
        'naming_pattern': r'^[a-z][a-z0-9_]*$'  # ì†Œë¬¸ìë§Œ
    },
    'ml': {
        'max_features': 200,
        'max_feature_name_length': 64,
        'required_features': ['event_time'],
        'encouraged_types': ['Fractional'],  # MLì— ìœ ë¦¬í•œ íƒ€ì…
        'max_vector_dimension': 2048,
        'min_vector_features': 1,
        'naming_pattern': r'^[a-zA-Z][a-zA-Z0-9_]*$'
    },
    'business': {
        'max_features': 75,
        'max_feature_name_length': 48,
        'required_features': ['event_time', 'customer_id'],
        'encouraged_features': ['created_at', 'updated_at'],
        'discouraged_types': [],
        'naming_pattern': r'^[a-zA-Z][a-zA-Z0-9_]*$'
    }
}

profile_config = VALIDATION_PROFILES.get('$validation_profile', VALIDATION_PROFILES['standard'])

# ìŠ¤í‚¤ë§ˆ ë¡œë“œ
with open('$temp_schema', 'r') as f:
    schema = json.load(f)

features = schema.get('FeatureDefinitions', [])
feature_count = len(features)

print(f"ğŸ” ìŠ¤í‚¤ë§ˆ ê²€ì¦ ë¦¬í¬íŠ¸ ($validation_profile í”„ë¡œí•„)")
print("=" * 60)
print(f"Feature Group: $feature_group")
print(f"ì´ Features: {feature_count}")
print(f"ìƒíƒœ: {schema.get('FeatureGroupStatus', 'Unknown')}")
print("")

# ê²€ì¦ ê²°ê³¼ ì €ì¥
validation_results = {
    'passed': [],
    'warnings': [],
    'errors': [],
    'recommendations': []
}

# 1. Feature ê°œìˆ˜ ê²€ì¦
max_features = profile_config.get('max_features', 100)
if feature_count > max_features:
    validation_results['warnings'].append(
        f"Feature ìˆ˜ê°€ ë§ìŠµë‹ˆë‹¤ ({feature_count}ê°œ > {max_features}ê°œ ê¶Œì¥)"
    )
else:
    validation_results['passed'].append(f"Feature ìˆ˜ ì ì ˆí•¨ ({feature_count}ê°œ)")

# 2. í•„ìˆ˜ Feature ê²€ì¦
required_features = profile_config.get('required_features', [])
feature_names = {f['FeatureName'].lower() for f in features}

for req_feature in required_features:
    if req_feature.lower() not in feature_names:
        validation_results['errors'].append(f"í•„ìˆ˜ Feature ëˆ„ë½: {req_feature}")
    else:
        validation_results['passed'].append(f"í•„ìˆ˜ Feature ì¡´ì¬: {req_feature}")

# 3. Feature ì´ë¦„ ê·œì¹™ ê²€ì¦
naming_pattern = profile_config.get('naming_pattern', r'^[a-zA-Z][a-zA-Z0-9_]*$')
max_name_length = profile_config.get('max_feature_name_length', 64)

for feature in features:
    name = feature['FeatureName']
    
    # ê¸¸ì´ ê²€ì¦
    if len(name) > max_name_length:
        validation_results['warnings'].append(f"Feature ì´ë¦„ì´ ê¹ë‹ˆë‹¤: {name} ({len(name)}ì)")
    
    # íŒ¨í„´ ê²€ì¦
    if not re.match(naming_pattern, name):
        validation_results['warnings'].append(f"ì´ë¦„ ê·œì¹™ ìœ„ë°˜: {name}")
    
    # ì˜ˆì•½ì–´ ê²€ì¦
    reserved_words = ['time', 'date', 'timestamp', 'id', 'key']
    if name.lower() in reserved_words:
        validation_results['warnings'].append(f"ì˜ˆì•½ì–´ ì‚¬ìš©: {name}")

# 4. Feature íƒ€ì… ë¶„í¬ ê²€ì¦
type_counter = Counter(f['FeatureType'] for f in features)

print("ğŸ“Š Feature Type ë¶„í¬:")
for ftype, count in type_counter.most_common():
    percentage = (count / feature_count) * 100
    print(f"  {ftype}: {count}ê°œ ({percentage:.1f}%)")

# íƒ€ì…ë³„ ê¶Œì¥ì‚¬í•­
if '$validation_profile' == 'ml':
    fractional_ratio = type_counter.get('Fractional', 0) / feature_count
    if fractional_ratio < 0.3:
        validation_results['recommendations'].append(
            f"MLìš©ë„ë¡œ Fractional íƒ€ì…ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ({fractional_ratio:.1%})"
        )

string_ratio = type_counter.get('String', 0) / feature_count  
if string_ratio > 0.7:
    validation_results['warnings'].append(
        f"String íƒ€ì…ì´ ë§ìŠµë‹ˆë‹¤ ({string_ratio:.1%}). ì¹´í…Œê³ ë¦¬ ì¸ì½”ë”©ì„ ê³ ë ¤í•´ë³´ì„¸ìš”"
    )

# 5. Collection íƒ€ì… ê²€ì¦
collection_features = [f for f in features if f.get('CollectionType')]
vector_features = [f for f in collection_features if f.get('CollectionType') == 'List']

if vector_features:
    print(f"\nğŸ“¦ Vector Features: {len(vector_features)}ê°œ")
    
    max_vector_dim = profile_config.get('max_vector_dimension', 1000)
    
    for vf in vector_features:
        name = vf['FeatureName']
        config = vf.get('CollectionConfig', {})
        vector_config = config.get('VectorConfig', {})
        dimension = vector_config.get('Dimension', 0)
        
        print(f"  {name}: {dimension}ì°¨ì›")
        
        if dimension > max_vector_dim:
            validation_results['warnings'].append(
                f"ë²¡í„° ì°¨ì›ì´ í½ë‹ˆë‹¤: {name} ({dimension}ì°¨ì›)"
            )
        elif dimension == 0:
            validation_results['errors'].append(f"ë²¡í„° ì°¨ì› ë¯¸ì„¤ì •: {name}")

# ML í”„ë¡œí•„ íŠ¹ë³„ ê²€ì¦
if '$validation_profile' == 'ml':
    min_vector_features = profile_config.get('min_vector_features', 0)
    if len(vector_features) < min_vector_features:
        validation_results['recommendations'].append(
            f"MLìš©ë„ë¡œ ë²¡í„° Featureê°€ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ ({len(vector_features)}ê°œ)"
        )

# 6. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦
business_patterns = {
    'timestamp_features': [f for f in features if any(keyword in f['FeatureName'].lower() 
                          for keyword in ['time', 'date', 'timestamp', 'created', 'updated'])],
    'id_features': [f for f in features if any(keyword in f['FeatureName'].lower() 
                   for keyword in ['id', 'identifier', 'key'])],
    'metric_features': [f for f in features if f['FeatureType'] in ['Fractional', 'Integral'] 
                       and any(keyword in f['FeatureName'].lower() 
                       for keyword in ['count', 'amount', 'value', 'score', 'rate'])]
}

print(f"\nğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ íŒ¨í„´ ë¶„ì„:")
for pattern_name, pattern_features in business_patterns.items():
    print(f"  {pattern_name.replace('_', ' ').title()}: {len(pattern_features)}ê°œ")

# 7. ë°ì´í„° í’ˆì§ˆ ì§€í‘œ ê²€ì¦
quality_indicators = []

# Event Time Feature í™•ì¸
event_time_feature = schema.get('EventTimeFeatureName')
if event_time_feature:
    event_time_type = next((f['FeatureType'] for f in features 
                          if f['FeatureName'] == event_time_feature), None)
    if event_time_type != 'Fractional':
        validation_results['warnings'].append(
            f"Event Time Featureê°€ Fractional íƒ€ì…ì´ ì•„ë‹™ë‹ˆë‹¤: {event_time_type}"
        )
    else:
        validation_results['passed'].append("Event Time Feature íƒ€ì… ì ì ˆí•¨")

# Record Identifier í™•ì¸
record_id_feature = schema.get('RecordIdentifierFeatureName')
if record_id_feature:
    record_id_type = next((f['FeatureType'] for f in features 
                         if f['FeatureName'] == record_id_feature), None)
    if record_id_type != 'String':
        validation_results['warnings'].append(
            f"Record Identifierê°€ String íƒ€ì…ì´ ì•„ë‹™ë‹ˆë‹¤: {record_id_type}"
        )

# ê²€ì¦ ê²°ê³¼ ì¶œë ¥
print(f"\nğŸ“‹ ê²€ì¦ ê²°ê³¼")
print("-" * 40)

if validation_results['passed']:
    print(f"âœ… í†µê³¼ ({len(validation_results['passed'])}ê°œ):")
    for result in validation_results['passed']:
        print(f"  âœ“ {result}")

if validation_results['warnings']:
    print(f"\nâš ï¸  ê²½ê³  ({len(validation_results['warnings'])}ê°œ):")
    for result in validation_results['warnings']:
        print(f"  âš  {result}")

if validation_results['errors']:
    print(f"\nâŒ ì˜¤ë¥˜ ({len(validation_results['errors'])}ê°œ):")
    for result in validation_results['errors']:
        print(f"  âœ— {result}")

if validation_results['recommendations']:
    print(f"\nğŸ’¡ ê¶Œì¥ì‚¬í•­ ({len(validation_results['recommendations'])}ê°œ):")
    for result in validation_results['recommendations']:
        print(f"  ğŸ’¡ {result}")

# ì „ì²´ ì ìˆ˜ ê³„ì‚°
total_checks = (len(validation_results['passed']) + 
               len(validation_results['warnings']) + 
               len(validation_results['errors']))
passed_checks = len(validation_results['passed'])
score = (passed_checks / total_checks * 100) if total_checks > 0 else 0

print(f"\nğŸ“Š ê²€ì¦ ì ìˆ˜: {score:.1f}% ({passed_checks}/{total_checks})")

if score >= 90:
    print("ğŸ† ìš°ìˆ˜í•œ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ì…ë‹ˆë‹¤!")
elif score >= 70:
    print("ğŸ‘ ì–‘í˜¸í•œ ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤. ëª‡ ê°€ì§€ ê°œì„ ì ì´ ìˆìŠµë‹ˆë‹¤.")
elif score >= 50:
    print("âš ï¸ ìŠ¤í‚¤ë§ˆ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.")
else:
    print("ğŸš¨ ìŠ¤í‚¤ë§ˆì— ì‹¬ê°í•œ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.")

# ê²€ì¦ ë¦¬í¬íŠ¸ íŒŒì¼ ìƒì„±
import os
os.system('mkdir -p schema_validations')

report_file = f"schema_validations/{schema['FeatureGroupName']}_validation_{profile_config}.txt"
with open(report_file.replace('$validation_profile', '$validation_profile'), 'w') as f:
    f.write(f"Schema Validation Report\\n")
    f.write(f"Feature Group: {schema['FeatureGroupName']}\\n")
    f.write(f"Profile: $validation_profile\\n")
    f.write(f"Date: $(date)\\n")
    f.write(f"Score: {score:.1f}%\\n\\n")
    
    for category, results in validation_results.items():
        if results:
            f.write(f"{category.upper()}:\\n")
            for result in results:
                f.write(f"  - {result}\\n")
            f.write("\\n")

print(f"\\nğŸ“„ ê²€ì¦ ë¦¬í¬íŠ¸ ì €ì¥ë¨: schema_validations/{schema['FeatureGroupName']}_validation_$validation_profile.txt")

EOF
    
    # ì •ë¦¬
    rm -f "$temp_schema"
    
    echo ""
    echo "âœ… ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì™„ë£Œ"
}

# ì‚¬ìš© ì˜ˆì‹œë“¤
echo "ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì˜ˆì‹œ:"
echo ""
echo "# í‘œì¤€ ê²€ì¦"
echo "validate_schema \"my-feature-group\" \"standard\""
echo ""
echo "# ML í”„ë¡œì íŠ¸ìš© ì—„ê²©í•œ ê²€ì¦"  
echo "validate_schema \"ml-features\" \"ml\""
echo ""
echo "# ë¹„ì¦ˆë‹ˆìŠ¤ ë°ì´í„°ìš© ê²€ì¦"
echo "validate_schema \"customer-data\" \"business\""
echo ""
echo "# ë§¤ìš° ì—„ê²©í•œ ê²€ì¦"
echo "validate_schema \"critical-features\" \"strict\""
```

### 4. ìŠ¤í‚¤ë§ˆ ë¬¸ì„œí™” ìƒì„±ê¸°

```bash
#!/bin/bash
# schema_documentation_generator.sh - ìŠ¤í‚¤ë§ˆ ìë™ ë¬¸ì„œí™”

generate_schema_docs() {
    local feature_groups=("$@")
    local output_dir="schema_docs"
    local timestamp=$(date +%Y%m%d_%H%M%S)
    
    if [ ${#feature_groups[@]} -eq 0 ]; then
        echo "ì‚¬ìš©ë²•: generate_schema_docs <feature-group-1> [feature-group-2] ..."
        return 1
    fi
    
    echo "ğŸ“š ìŠ¤í‚¤ë§ˆ ë¬¸ì„œí™” ìƒì„±ê¸°"
    echo "ëŒ€ìƒ Feature Groups: ${feature_groups[*]}"
    echo ""
    
    # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
    mkdir -p "$output_dir"
    
    # ë§ˆìŠ¤í„° ì¸ë±ìŠ¤ HTML ìƒì„±
    index_file="$output_dir/index.html"
    
    cat > "$index_file" << 'HTML_HEADER'
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Store ìŠ¤í‚¤ë§ˆ ë¬¸ì„œ</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background-color: #f5f5f5; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            padding: 30px; 
        }
        .header { 
            border-bottom: 3px solid #007acc; 
            padding-bottom: 20px; 
            margin-bottom: 30px; 
        }
        .feature-group { 
            margin: 20px 0; 
            padding: 20px; 
            border: 1px solid #ddd; 
            border-radius: 6px; 
            background-color: #fafafa; 
        }
        .feature-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 15px 0; 
        }
        .feature-table th, .feature-table td { 
            border: 1px solid #ddd; 
            padding: 12px; 
            text-align: left; 
        }
        .feature-table th { 
            background-color: #007acc; 
            color: white; 
        }
        .feature-table tbody tr:nth-child(even) { 
            background-color: #f9f9f9; 
        }
        .type-string { color: #28a745; font-weight: bold; }
        .type-integral { color: #007acc; font-weight: bold; }
        .type-fractional { color: #dc3545; font-weight: bold; }
        .collection-list { background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; }
        .collection-set { background-color: #d4edda; padding: 2px 6px; border-radius: 3px; }
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
            margin: 20px 0; 
        }
        .stat-card { 
            background: white; 
            padding: 15px; 
            border-radius: 6px; 
            border-left: 4px solid #007acc; 
            text-align: center; 
        }
        .stat-number { 
            font-size: 2em; 
            font-weight: bold; 
            color: #007acc; 
        }
        .nav-links { 
            margin: 20px 0; 
        }
        .nav-links a { 
            display: inline-block; 
            margin-right: 15px; 
            padding: 8px 15px; 
            background-color: #007acc; 
            color: white; 
            text-decoration: none; 
            border-radius: 4px; 
        }
        .nav-links a:hover { 
            background-color: #0056b3; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ƒï¸ Feature Store ìŠ¤í‚¤ë§ˆ ë¬¸ì„œ</h1>
            <p>ìƒì„±ì¼: <strong>TIMESTAMP_PLACEHOLDER</strong></p>
            <p>Feature Groups: <strong>COUNT_PLACEHOLDER</strong>ê°œ</p>
        </div>
HTML_HEADER
    
    # ê° Feature Group ë¬¸ì„œí™”
    total_features=0
    
    for fg in "${feature_groups[@]}"; do
        echo "ğŸ“Š $fg ë¬¸ì„œí™” ì¤‘..."
        
        # ìŠ¤í‚¤ë§ˆ ì •ë³´ ìˆ˜ì§‘
        schema_file="/tmp/${fg}_schema_doc.json"
        
        if ! fs schema "$fg" --format json > "$schema_file"; then
            echo "  âŒ $fg ìŠ¤í‚¤ë§ˆ ìˆ˜ì§‘ ì‹¤íŒ¨"
            continue
        fi
        
        # Pythonì„ ì‚¬ìš©í•œ HTML ìƒì„±
        python3 << EOF
import json
from collections import Counter

with open('$schema_file', 'r') as f:
    schema = json.load(f)

fg_name = schema['FeatureGroupName']
features = schema.get('FeatureDefinitions', [])
feature_count = len(features)
status = schema.get('FeatureGroupStatus', 'Unknown')
record_id = schema.get('RecordIdentifierFeatureName', 'N/A')
event_time = schema.get('EventTimeFeatureName', 'N/A')

# Feature type í†µê³„
type_counter = Counter(f['FeatureType'] for f in features)
collection_counter = Counter(f.get('CollectionType', 'None') for f in features)

# HTML ì„¹ì…˜ ìƒì„±
html_content = f'''
        <div class="feature-group" id="{fg_name}">
            <h2>ğŸ“Š {fg_name}</h2>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">{feature_count}</div>
                    <div>Total Features</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{type_counter.get('String', 0)}</div>
                    <div>String Features</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{type_counter.get('Integral', 0)}</div>
                    <div>Integral Features</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{type_counter.get('Fractional', 0)}</div>
                    <div>Fractional Features</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{collection_counter.get('List', 0)}</div>
                    <div>Vector Features</div>
                </div>
            </div>
            
            <h3>ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>
            <ul>
                <li><strong>ìƒíƒœ:</strong> {status}</li>
                <li><strong>Record Identifier:</strong> {record_id}</li>
                <li><strong>Event Time Feature:</strong> {event_time}</li>
                <li><strong>ì´ Features:</strong> {feature_count}ê°œ</li>
            </ul>
            
            <h3>ğŸ” Feature ì •ì˜</h3>
            <table class="feature-table">
                <thead>
                    <tr>
                        <th>Feature Name</th>
                        <th>Type</th>
                        <th>Collection</th>
                        <th>Dimension</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
'''

for feature in sorted(features, key=lambda x: x['FeatureName']):
    name = feature['FeatureName']
    ftype = feature['FeatureType']
    collection_type = feature.get('CollectionType', '')
    description = feature.get('Description', '-')
    
    # Type í´ë˜ìŠ¤ ì„¤ì •
    type_class = f"type-{ftype.lower()}"
    
    # Collection ì •ë³´
    collection_display = ''
    dimension = ''
    
    if collection_type == 'List':
        collection_display = '<span class="collection-list">List</span>'
        config = feature.get('CollectionConfig', {})
        vector_config = config.get('VectorConfig', {})
        dimension = str(vector_config.get('Dimension', '-'))
    elif collection_type == 'Set':
        collection_display = '<span class="collection-set">Set</span>'
    
    html_content += f'''
                    <tr>
                        <td><strong>{name}</strong></td>
                        <td><span class="{type_class}">{ftype}</span></td>
                        <td>{collection_display}</td>
                        <td>{dimension}</td>
                        <td>{description}</td>
                    </tr>'''

html_content += '''
                </tbody>
            </table>
        </div>
'''

# íŒŒì¼ì— ì¶”ê°€
with open('$index_file', 'a') as f:
    f.write(html_content)

print(f"  âœ… {fg_name}: {feature_count}ê°œ features")

EOF
        
        total_features=$((total_features + $(jq '.TotalFeatures' "$schema_file")))
        rm -f "$schema_file"
    done
    
    # HTML ë§ˆë¬´ë¦¬
    cat >> "$index_file" << 'HTML_FOOTER'
        
        <div class="footer" style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666;">
            <p>ğŸ“„ ì´ ë¬¸ì„œëŠ” SageMaker Feature Store CLIë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
        </div>
    </div>
    
    <script>
        // ê°„ë‹¨í•œ ê²€ìƒ‰ ê¸°ëŠ¥
        document.addEventListener('DOMContentLoaded', function() {
            // ë„¤ë¹„ê²Œì´ì…˜ ë§í¬ ì¶”ê°€
            const navLinks = document.createElement('div');
            navLinks.className = 'nav-links';
            navLinks.innerHTML = '<h3>ğŸ“Œ Quick Navigation</h3>';
            
            document.querySelectorAll('.feature-group').forEach(fg => {
                const id = fg.id;
                const name = fg.querySelector('h2').textContent;
                navLinks.innerHTML += `<a href="#${id}">${name}</a>`;
            });
            
            document.querySelector('.header').appendChild(navLinks);
        });
    </script>
</body>
</html>
HTML_FOOTER
    
    # í”Œë ˆì´ìŠ¤í™€ë” êµì²´
    sed -i "s/TIMESTAMP_PLACEHOLDER/$(date)/" "$index_file"
    sed -i "s/COUNT_PLACEHOLDER/${#feature_groups[@]}/" "$index_file"
    
    # ì¶”ê°€ ë¦¬í¬íŠ¸ ìƒì„±
    summary_file="$output_dir/summary.txt"
    
    cat > "$summary_file" << EOF
Feature Store Schema Documentation Summary
=========================================

Generated: $(date)
Feature Groups: ${#feature_groups[@]}
Total Features: $total_features

Feature Groups:
$(printf "  - %s\n" "${feature_groups[@]}")

Files Generated:
  - index.html       : Main documentation
  - summary.txt      : This summary

To view the documentation, open:
  file://$(pwd)/$index_file
EOF
    
    echo ""
    echo "ğŸ“š ìŠ¤í‚¤ë§ˆ ë¬¸ì„œí™” ì™„ë£Œ!"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "Feature Groups: ${#feature_groups[@]}ê°œ"
    echo "ì´ Features: $total_featuresê°œ"
    echo ""
    echo "ğŸ“„ ìƒì„±ëœ íŒŒì¼ë“¤:"
    echo "  - HTML ë¬¸ì„œ: $index_file"
    echo "  - ìš”ì•½ íŒŒì¼: $summary_file"
    echo ""
    echo "ğŸŒ ë¸Œë¼ìš°ì €ì—ì„œ ë³´ê¸°:"
    echo "  file://$(pwd)/$index_file"
    
    # ë¸Œë¼ìš°ì €ë¡œ ìë™ ì—´ê¸° (ì„ íƒì‚¬í•­)
    if command -v xdg-open >/dev/null; then
        echo ""
        echo "ë¸Œë¼ìš°ì €ì—ì„œ ìë™ìœ¼ë¡œ ì—´ê¹Œìš”? (y/N)"
        read -r open_browser
        if [[ $open_browser =~ ^[Yy]$ ]]; then
            xdg-open "$index_file"
        fi
    fi
}

# ì‚¬ìš© ì˜ˆì‹œ
generate_schema_docs "customer-profiles" "product-catalog" "user-interactions"
```

### 5. ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ì½”ë“œ ìƒì„±ê¸°

```bash
#!/bin/bash
# schema_code_generator.sh - ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ì½”ë“œ ìë™ ìƒì„±

generate_code_from_schema() {
    local feature_group="$1"
    local language="${2:-python}"  # python, java, typescript
    local output_dir="generated_code"
    
    if [ -z "$feature_group" ]; then
        echo "ì‚¬ìš©ë²•: generate_code_from_schema <feature-group-name> [language]"
        echo "Languages: python, java, typescript"
        return 1
    fi
    
    echo "ğŸ”§ ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ì½”ë“œ ìƒì„±ê¸°"
    echo "Feature Group: $feature_group"
    echo "ì–¸ì–´: $language"
    echo ""
    
    # ìŠ¤í‚¤ë§ˆ ì •ë³´ ìˆ˜ì§‘
    schema_file="/tmp/${feature_group}_codegen.json"
    
    if ! fs schema "$feature_group" --format json > "$schema_file"; then
        echo "âŒ ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
        return 1
    fi
    
    # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
    mkdir -p "$output_dir/$language"
    
    # ì–¸ì–´ë³„ ì½”ë“œ ìƒì„±
    case "$language" in
        "python")
            generate_python_code "$feature_group" "$schema_file" "$output_dir/python"
            ;;
        "java")
            generate_java_code "$feature_group" "$schema_file" "$output_dir/java"
            ;;
        "typescript")
            generate_typescript_code "$feature_group" "$schema_file" "$output_dir/typescript"
            ;;
        *)
            echo "âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì–¸ì–´: $language"
            return 1
            ;;
    esac
    
    rm -f "$schema_file"
}

generate_python_code() {
    local feature_group="$1"
    local schema_file="$2"
    local output_dir="$3"
    
    echo "ğŸ Python ì½”ë“œ ìƒì„± ì¤‘..."
    
    python3 << EOF
import json
from datetime import datetime

with open('$schema_file', 'r') as f:
    schema = json.load(f)

fg_name = schema['FeatureGroupName']
features = schema.get('FeatureDefinitions', [])
record_id_feature = schema.get('RecordIdentifierFeatureName', 'record_id')
event_time_feature = schema.get('EventTimeFeatureName', 'event_time')

# í´ë˜ìŠ¤ëª… ìƒì„± (PascalCase)
class_name = ''.join(word.capitalize() for word in fg_name.replace('-', '_').split('_'))

# Python ë°ì´í„° í´ë˜ìŠ¤ ìƒì„±
python_code = f'''"""
Auto-generated Feature Store model for {fg_name}
Generated on: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
"""

from typing import Optional, List, Dict, Any, Union
from dataclasses import dataclass
from datetime import datetime
import boto3
import json


@dataclass
class {class_name}Feature:
    """Feature data class for {fg_name}"""
'''

# ê° featureë¥¼ í´ë˜ìŠ¤ í•„ë“œë¡œ ì¶”ê°€
for feature in features:
    name = feature['FeatureName']
    ftype = feature['FeatureType']
    collection_type = feature.get('CollectionType')
    
    # Python íƒ€ì… ë§¤í•‘
    python_type = 'str'  # ê¸°ë³¸ê°’
    if ftype == 'Integral':
        python_type = 'int'
    elif ftype == 'Fractional':
        python_type = 'float'
    
    if collection_type == 'List':
        python_type = f'List[{python_type}]'
    elif collection_type == 'Set':
        python_type = f'List[{python_type}]'  # Feature StoreëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©
    
    # Optional ì²˜ë¦¬ (record_idì™€ event_time ì œì™¸)
    if name not in [record_id_feature, event_time_feature]:
        python_type = f'Optional[{python_type}]'
        default_value = ' = None'
    else:
        default_value = ''
    
    python_code += f'    {name}: {python_type}{default_value}\n'

# Helper ë©”ì†Œë“œë“¤ ì¶”ê°€
python_code += f'''

    def to_feature_record(self) -> Dict[str, Any]:
        """Convert to Feature Store record format"""
        record = {{}}
        
        for field_name, field_value in self.__dict__.items():
            if field_value is not None:
                if isinstance(field_value, (list, tuple)):
                    record[field_name] = [str(item) for item in field_value]
                elif isinstance(field_value, (int, float)):
                    record[field_name] = str(field_value)
                else:
                    record[field_name] = str(field_value)
        
        return record
    
    @classmethod
    def from_feature_record(cls, record: Dict[str, str]) -> '{class_name}Feature':
        """Create instance from Feature Store record"""
        kwargs = {{}}
        
'''

# from_feature_record ë©”ì†Œë“œì˜ í•„ë“œë³„ íŒŒì‹± ë¡œì§
for feature in features:
    name = feature['FeatureName']
    ftype = feature['FeatureType']
    collection_type = feature.get('CollectionType')
    
    python_code += f'''        if '{name}' in record:
            value = record['{name}']
            if value:  # ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°
'''
    
    if collection_type:
        python_code += f'''                # Collection type parsing
                if isinstance(value, str):
                    value = json.loads(value) if value.startswith('[') else [value]
'''
        if ftype == 'Integral':
            python_code += f'                kwargs["{name}"] = [int(x) for x in value]\n'
        elif ftype == 'Fractional':
            python_code += f'                kwargs["{name}"] = [float(x) for x in value]\n'
        else:
            python_code += f'                kwargs["{name}"] = value\n'
    else:
        if ftype == 'Integral':
            python_code += f'                kwargs["{name}"] = int(value)\n'
        elif ftype == 'Fractional':
            python_code += f'                kwargs["{name}"] = float(value)\n'
        else:
            python_code += f'                kwargs["{name}"] = value\n'

python_code += f'''        
        return cls(**kwargs)


class {class_name}Client:
    """Feature Store client for {fg_name}"""
    
    def __init__(self, region_name: str = None):
        self.feature_group_name = '{fg_name}'
        self.sagemaker_client = boto3.client('sagemaker-featurestore-runtime', 
                                           region_name=region_name)
    
    def get_record(self, {record_id_feature}: str, 
                   feature_names: Optional[List[str]] = None) -> Optional[{class_name}Feature]:
        """Get a single record from the feature store"""
        try:
            kwargs = {{
                'FeatureGroupName': self.feature_group_name,
                'RecordIdentifierValueAsString': {record_id_feature}
            }}
            
            if feature_names:
                kwargs['FeatureNames'] = feature_names
            
            response = self.sagemaker_client.get_record(**kwargs)
            
            if 'Record' in response:
                record_dict = {{item['FeatureName']: item['ValueAsString'] 
                              for item in response['Record']}}
                return {class_name}Feature.from_feature_record(record_dict)
            
            return None
            
        except Exception as e:
            print(f"Error getting record: {{e}}")
            return None
    
    def put_record(self, feature_data: {class_name}Feature) -> bool:
        """Put a record into the feature store"""
        try:
            record_dict = feature_data.to_feature_record()
            
            # Feature Store í˜•ì‹ìœ¼ë¡œ ë³€í™˜
            record_list = [
                {{'FeatureName': name, 'ValueAsString': str(value)}}
                for name, value in record_dict.items()
            ]
            
            self.sagemaker_client.put_record(
                FeatureGroupName=self.feature_group_name,
                Record=record_list
            )
            
            return True
            
        except Exception as e:
            print(f"Error putting record: {{e}}")
            return False
    
    def batch_get_records(self, record_ids: List[str], 
                         feature_names: Optional[List[str]] = None) -> List[{class_name}Feature]:
        """Get multiple records from the feature store"""
        results = []
        
        for record_id in record_ids:
            record = self.get_record(record_id, feature_names)
            if record:
                results.append(record)
        
        return results


# Example usage
if __name__ == "__main__":
    # Create client
    client = {class_name}Client()
    
    # Example feature data
    feature_data = {class_name}Feature(
'''

# ì˜ˆì œ ë°ì´í„° ìƒì„±
example_values = []
for feature in features:
    name = feature['FeatureName']
    ftype = feature['FeatureType']
    collection_type = feature.get('CollectionType')
    
    if name == record_id_feature:
        example_values.append(f'        {name}="example-123"')
    elif name == event_time_feature:
        example_values.append(f'        {name}=int(datetime.now().timestamp())')
    else:
        if collection_type:
            if ftype == 'Integral':
                example_values.append(f'        {name}=[1, 2, 3]')
            elif ftype == 'Fractional':
                example_values.append(f'        {name}=[1.0, 2.0, 3.0]')
            else:
                example_values.append(f'        {name}=["value1", "value2"]')
        else:
            if ftype == 'Integral':
                example_values.append(f'        {name}=42')
            elif ftype == 'Fractional':
                example_values.append(f'        {name}=3.14')
            else:
                example_values.append(f'        {name}="example_value"')

python_code += ',\n'.join(example_values)

python_code += f'''
    )
    
    # Put record
    print("Putting record...")
    success = client.put_record(feature_data)
    print(f"Put record success: {{success}}")
    
    # Get record
    print("Getting record...")
    retrieved = client.get_record("example-123")
    print(f"Retrieved record: {{retrieved}}")
'''

# íŒŒì¼ ì €ì¥
output_file = f'$output_dir/{fg_name.replace("-", "_")}_model.py'
with open(output_file, 'w') as f:
    f.write(python_code)

print(f"  âœ… Python ëª¨ë¸ í´ë˜ìŠ¤: {output_file}")

# ì¶”ê°€ë¡œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ìƒì„±
util_code = f'''"""
Utility functions for {fg_name} Feature Store operations
"""

import pandas as pd
from typing import List, Dict, Any
from .{fg_name.replace("-", "_")}_model import {class_name}Feature, {class_name}Client


def dataframe_to_features(df: pd.DataFrame) -> List[{class_name}Feature]:
    """Convert pandas DataFrame to list of Feature objects"""
    features = []
    
    for _, row in df.iterrows():
        kwargs = {{}}
        for column in df.columns:
            if pd.notna(row[column]):
                kwargs[column] = row[column]
        
        features.append({class_name}Feature(**kwargs))
    
    return features


def features_to_dataframe(features: List[{class_name}Feature]) -> pd.DataFrame:
    """Convert list of Feature objects to pandas DataFrame"""
    data = []
    
    for feature in features:
        data.append(feature.__dict__)
    
    return pd.DataFrame(data)


def validate_feature_data(feature: {class_name}Feature) -> List[str]:
    """Validate feature data and return list of errors"""
    errors = []
    
    # Required field validation
    if not getattr(feature, '{record_id_feature}', None):
        errors.append(f"Missing required field: {record_id_feature}")
    
    if not getattr(feature, '{event_time_feature}', None):
        errors.append(f"Missing required field: {event_time_feature}")
    
'''

# íƒ€ì…ë³„ ê²€ì¦ ë¡œì§ ì¶”ê°€
for feature in features:
    name = feature['FeatureName']
    ftype = feature['FeatureType']
    
    if name not in [record_id_feature, event_time_feature]:
        continue
    
    util_code += f'''    # Validate {name}
    {name}_value = getattr(feature, '{name}', None)
    if {name}_value is not None:
'''
    
    if ftype == 'Integral':
        util_code += f'        if not isinstance({name}_value, int):\n'
        util_code += f'            errors.append(f"{name} must be an integer")\n'
    elif ftype == 'Fractional':
        util_code += f'        if not isinstance({name}_value, (int, float)):\n'
        util_code += f'            errors.append(f"{name} must be a number")\n'

util_code += '''
    return errors


def batch_put_features(client: {class_name}Client, features: List[{class_name}Feature], 
                      batch_size: int = 100) -> Dict[str, int]:
    """Batch put multiple features with error handling"""
    results = {"success": 0, "failed": 0, "errors": []}
    
    for i in range(0, len(features), batch_size):
        batch = features[i:i + batch_size]
        
        for feature in batch:
            # Validate before putting
            validation_errors = validate_feature_data(feature)
            if validation_errors:
                results["failed"] += 1
                results["errors"].extend(validation_errors)
                continue
            
            # Put record
            if client.put_record(feature):
                results["success"] += 1
            else:
                results["failed"] += 1
    
    return results
'''

util_output_file = f'$output_dir/{fg_name.replace("-", "_")}_utils.py'
with open(util_output_file, 'w') as f:
    f.write(util_code)

print(f"  âœ… Python ìœ í‹¸ë¦¬í‹°: {util_output_file}")

EOF
}

# ì‚¬ìš© ì˜ˆì‹œ
echo "Python ì½”ë“œ ìƒì„± ì˜ˆì‹œ:"
echo "generate_python_code \"customer-profiles\" \"schema.json\" \"output/python\""
```

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜ë“¤

```bash
# Feature Groupì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
âŒ ì˜¤ë¥˜: í”¼ì²˜ ê·¸ë£¹ 'non-existent'ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
# í•´ê²°: Feature Group ì´ë¦„ í™•ì¸

# ê¶Œí•œ ë¶€ì¡±
âŒ AWS ì˜¤ë¥˜: AccessDeniedException
# í•´ê²°: SageMaker DescribeFeatureGroup ê¶Œí•œ í•„ìš”

# ì˜ëª»ëœ ì¶œë ¥ í˜•ì‹
âŒ Invalid value for "--output-format"
# í•´ê²°: table ë˜ëŠ” json ì‚¬ìš©
```

### ìŠ¤í‚¤ë§ˆ ì •ë³´ê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ” ê²½ìš°

```bash
#!/bin/bash
# schema_troubleshoot.sh

diagnose_schema_issues() {
    local feature_group="$1"
    
    echo "ğŸ”§ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ ë¬¸ì œ ì§„ë‹¨"
    echo "Feature Group: $feature_group"
    echo ""
    
    # 1. Feature Group ì¡´ì¬ í™•ì¸
    echo "1. Feature Group ì¡´ì¬ í™•ì¸..."
    if aws sagemaker describe-feature-group \
       --feature-group-name "$feature_group" >/dev/null 2>&1; then
        echo "  âœ… Feature Group ì¡´ì¬í•¨"
    else
        echo "  âŒ Feature Groupì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
        echo "  ğŸ’¡ ì‚¬ìš© ê°€ëŠ¥í•œ Feature Groups:"
        fs list | head -10
        return 1
    fi
    
    # 2. Feature Group ìƒíƒœ í™•ì¸
    echo ""
    echo "2. Feature Group ìƒíƒœ í™•ì¸..."
    status=$(aws sagemaker describe-feature-group \
            --feature-group-name "$feature_group" \
            --query 'FeatureGroupStatus' --output text)
    
    case "$status" in
        "Created")
            echo "  âœ… ìƒíƒœ ì •ìƒ: $status"
            ;;
        "Creating")
            echo "  â³ ìƒì„± ì¤‘: $status"
            echo "  ğŸ’¡ ìƒì„± ì™„ë£Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”"
            ;;
        "CreateFailed")
            echo "  âŒ ìƒì„± ì‹¤íŒ¨: $status"
            echo "  ğŸ’¡ Feature Group ì¬ìƒì„±ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
            ;;
        *)
            echo "  âš ï¸  ì•Œ ìˆ˜ ì—†ëŠ” ìƒíƒœ: $status"
            ;;
    esac
    
    # 3. ê¶Œí•œ í™•ì¸
    echo ""
    echo "3. ê¶Œí•œ í™•ì¸..."
    if aws sts get-caller-identity >/dev/null 2>&1; then
        echo "  âœ… AWS ì¸ì¦ ì„±ê³µ"
        
        identity=$(aws sts get-caller-identity --query 'Arn' --output text)
        echo "  í˜„ì¬ ì‚¬ìš©ì: $identity"
    else
        echo "  âŒ AWS ì¸ì¦ ì‹¤íŒ¨"
        echo "  ğŸ’¡ AWS ìê²©ì¦ëª…ì„ í™•ì¸í•´ì£¼ì„¸ìš”"
        return 1
    fi
    
    # 4. ì‹¤ì œ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ í…ŒìŠ¤íŠ¸
    echo ""
    echo "4. ìŠ¤í‚¤ë§ˆ ì¡°íšŒ í…ŒìŠ¤íŠ¸..."
    
    if fs schema "$feature_group" --format json >/dev/null 2>&1; then
        echo "  âœ… ìŠ¤í‚¤ë§ˆ ì¡°íšŒ ì„±ê³µ"
        
        feature_count=$(fs schema "$feature_group" --format json | jq '.TotalFeatures')
        echo "  Feature ìˆ˜: $feature_count"
    else
        echo "  âŒ ìŠ¤í‚¤ë§ˆ ì¡°íšŒ ì‹¤íŒ¨"
        echo "  ğŸ’¡ ìƒì„¸ ì˜¤ë¥˜ í™•ì¸:"
        fs schema "$feature_group" --format json 2>&1 | head -5
    fi
    
    echo ""
    echo "ğŸ” ì§„ë‹¨ ì™„ë£Œ"
}

# ì‚¬ìš© ì˜ˆì‹œ
diagnose_schema_issues "problematic-feature-group"
```

## ê´€ë ¨ ëª…ë ¹ì–´

- [`add-features`](12.add-features.md) - ìƒˆë¡œìš´ feature ì¶”ê°€
- [`schema-template`](14.schema-template.md) - Feature definition í…œí”Œë¦¿ ìƒì„±
- [`list`](01.list.md) - Feature Group ëª©ë¡ í™•ì¸
- [`create`](02.create.md) - ìƒˆ Feature Group ìƒì„±

## ì°¸ê³ ì‚¬í•­

- **ì‹¤ì‹œê°„ ì •ë³´**: í˜„ì¬ Feature Groupì˜ ìµœì‹  ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤
- **JSON ì¶œë ¥**: API í†µí•©ì´ë‚˜ ìë™í™”ì— ì í•©í•œ êµ¬ì¡°í™”ëœ ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤
- **í…Œì´ë¸” ì¶œë ¥**: ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ í˜•íƒœë¡œ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤
- **ë©”íƒ€ë°ì´í„° í¬í•¨**: Feature ì •ì˜ë¿ë§Œ ì•„ë‹ˆë¼ Feature Groupì˜ ì „ì²´ ë©”íƒ€ë°ì´í„°ë¥¼ ì œê³µí•©ë‹ˆë‹¤